{
  "hash": "2467d7c89d18d4d6fb61a07c96279ea5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Script 6 - Predictions\"\nauthor: \n  - name: \"MSc. Friederike Johanna Rosa Wölke\"\n    orcid: \"0000-0001-9034-4883\"\n    url: \"https://friedarosa.github.io\"\n    email: \"wolke@fzp.czu.cz\"\n    corresponding: true\ndate: \"2023-06-29\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nrm(list=ls())\nsource(\"src/functions.R\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLade nötiges Paket: caret\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLade nötiges Paket: ggplot2\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLade nötiges Paket: lattice\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLade nötiges Paket: caretEnsemble\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttache Paket: 'caretEnsemble'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDas folgende Objekt ist maskiert 'package:ggplot2':\n\n    autoplot\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLade nötiges Paket: plyr\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLade nötiges Paket: dplyr\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttache Paket: 'dplyr'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDie folgenden Objekte sind maskiert von 'package:plyr':\n\n    arrange, count, desc, failwith, id, mutate, rename, summarise,\n    summarize\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDie folgenden Objekte sind maskiert von 'package:stats':\n\n    filter, lag\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDie folgenden Objekte sind maskiert von 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLade nötiges Paket: randomForest\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nrandomForest 4.7-1.1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nType rfNews() to see new features/changes/bug fixes.\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttache Paket: 'randomForest'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDas folgende Objekt ist maskiert 'package:dplyr':\n\n    combine\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDas folgende Objekt ist maskiert 'package:ggplot2':\n\n    margin\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLade nötiges Paket: recipes\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttache Paket: 'recipes'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDas folgende Objekt ist maskiert 'package:stats':\n\n    step\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLade nötiges Paket: kableExtra\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\n\nAttache Paket: 'kableExtra'\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stderr}\n\n```\nDas folgende Objekt ist maskiert 'package:dplyr':\n\n    group_rows\n```\n\n\n:::\n\n```{.r .cell-code}\nload(\"data/RData/01_Data_prep.RData\")\nall_models <- readRDS(\"data/models/reducedModels/03_List_all_reduced_models.rds\")[c(\"Jaccard1\", \"LogRatio1\")]\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall_and_load(c(\"dplyr\", \"caret\", \"caretEnsemble\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## Predict Jaccard\nfile_path <- \"data/AllPredictors.rds\"\ntp <- 2\nvars <- c(H1_vars, H2_vars, H3_vars, H4_vars)\n\ndat <- readRDS(file_path) %>% \n  filter(cell_grouping == 1 & exclude == 0 & tp == tp_value) %>% \n  select(all_of(c( \"verbatim_name\", vars))) %>% \n  mutate(\n    D_AOO_a = case_when(\n      is.na(D_AOO_a) & rel_occ_Ncells > 0.97 ~ 2,\n      TRUE ~ D_AOO_a),\n    mean_prob_cooccur = case_when(\n      is.na(mean_prob_cooccur) & rel_occ_Ncells < 0.05 ~ 0, \n      TRUE ~ mean_prob_cooccur)) %>%\n  filter(!is.na(moran)) %>% \n  mutate_if(\n    is.character, as.factor) %>%\n  mutate_at(\n    vars(c(Habitat.Density, Migration)), as.factor) %>%\n  na.omit()\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndat$Jacc_pred <- predict(all_models[\"Jaccard1\"]$Jaccard1$ranger, newdata = dat)\n\ndat$LogRatio_pred <- predict(all_models[\"LogRatio1\"]$LogRatio1$ranger, newdata = dat)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data = dat)+\n  geom_histogram(aes(Jacc_pred, fill = dataset))+\n  facet_wrap(~dataset)+\n  theme_classic()+\n    geom_vline(xintercept = c(1,0))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](06_Predictions_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data = dat)+\n  geom_histogram(aes(LogRatio_pred, fill = dataset))+\n  facet_wrap(~dataset)+\n  theme_classic()+\n  geom_vline(xintercept = c(0))\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](06_Predictions_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "06_Predictions_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}