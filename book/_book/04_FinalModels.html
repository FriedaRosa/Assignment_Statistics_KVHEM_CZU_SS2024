<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="MSc. Friederike Johanna Rosa Wölke">
<meta name="dcterms.date" content="2023-05-29">

<title>Assignment Statistics KVHEM CZU SS 2024 - 4&nbsp; Script 4 - FinalModels</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05_VarPart.html" rel="next">
<link href="./03_HyperparameterTuning.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04_FinalModels.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Script 4 - FinalModels</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Assignment Statistics KVHEM CZU SS 2024</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/FriedaRosa/Assignment_Statistics_KVHEM_CZU_SS2024" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Assignment-Statistics-KVHEM-CZU-SS-2024.pdf">
              <i class="bi bi-bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Assignment-Statistics-KVHEM-CZU-SS-2024.epub">
              <i class="bi bi-bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignment for PhD Statistics class 2024</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_DataPrep.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Script 1 - Data preparation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_rfe.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Script 2 - Recursive Feature Selection</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_HyperparameterTuning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Script 3 - Hyperparameter Tuning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_FinalModels.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Script 4 - FinalModels</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_VarPart.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">MachineLearning - Script 5 - Variation Partitioning</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#train-all-models-together" id="toc-train-all-models-together" class="nav-link active" data-scroll-target="#train-all-models-together"><span class="header-section-number">4.0.1</span> Train all models together</a></li>
  <li><a href="#jaccard-1" id="toc-jaccard-1" class="nav-link" data-scroll-target="#jaccard-1"><span class="header-section-number">5</span> Jaccard 1</a></li>
  <li><a href="#jaccard-2" id="toc-jaccard-2" class="nav-link" data-scroll-target="#jaccard-2"><span class="header-section-number">6</span> Jaccard 2</a></li>
  <li><a href="#log-ratio-1" id="toc-log-ratio-1" class="nav-link" data-scroll-target="#log-ratio-1"><span class="header-section-number">7</span> Log Ratio 1</a></li>
  <li><a href="#log-ratio-2" id="toc-log-ratio-2" class="nav-link" data-scroll-target="#log-ratio-2"><span class="header-section-number">8</span> Log Ratio 2</a></li>
  <li><a href="#save-the-models" id="toc-save-the-models" class="nav-link" data-scroll-target="#save-the-models"><span class="header-section-number">9</span> Save the models</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/FriedaRosa/Assignment_Statistics_KVHEM_CZU_SS2024/edit/main/04_FinalModels.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Script 4 - FinalModels</span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p><a href="https://friedarosa.github.io">MSc. Friederike Johanna Rosa Wölke</a> <a href="mailto:wolke@fzp.czu.cz" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0001-9034-4883" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 29, 2023</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Source custom functions</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">MachineLearning packages</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Load RData to reduce computing time</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"../src/functions.R"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pckgs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"dplyr"</span>, <span class="st">"ggplot2"</span>, <span class="st">"reshape2"</span>, </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>           <span class="st">"ggcorrplot"</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>           <span class="st">"caret"</span>,  <span class="st">"recipes"</span>,   <span class="st">"caretEnsemble"</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>           <span class="st">"randomForest"</span>, <span class="st">"ranger"</span>, <span class="st">"gbm"</span>, <span class="st">"xgboost"</span>, </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>           <span class="st">"vegan"</span>, <span class="st">"pdp"</span>, </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>           <span class="st">"gridExtra"</span>, <span class="st">"kableExtra"</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">install_and_load</span>(pckgs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load workspace to save computing time:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## it has: varPart from ranger models</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## recursive feature selection results</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># load("data/varPart_rfe.RData")</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># load("data/models.RData")</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"../data/RData/03_reduced_hyper_para_tuning_all_models.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<section id="train-all-models-together" class="level3" data-number="4.0.1">
<h3 data-number="4.0.1" class="anchored" data-anchor-id="train-all-models-together"><span class="header-section-number">4.0.1</span> Train all models together</h3>
</section>
<section id="jaccard-1" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Jaccard 1</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Train model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">Summarize individual models</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">Predictive performances</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">Ensemble model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Summarize predictor importances</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>(<span class="st">"J1"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define model variables  (response, indices and predictors)</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="st">"Jaccard"</span> <span class="co"># Replace with your actual response variable name</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> reduced_predictors[[<span class="dv">1</span>]] <span class="co"># Replace with your actual predictors</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> indices_J1</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> dat_train_J1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(response, predictors)))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>dd_test <span class="ot">&lt;-</span> dat_test_J1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(response, predictors)))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define training control</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>trained_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">savePredictions =</span> <span class="st">"final"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">returnResamp =</span> <span class="st">"final"</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">verboseIter =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> index <span class="co"># Ensure indices_J1 is defined</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Train all models at once using caretList / using bestFit hyperparameters from 03_HyperparameterTuning.qmd</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>modelsList_J1 <span class="ot">&lt;-</span> <span class="fu">caretList</span>(</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.formula</span>(<span class="fu">paste</span>(response, <span class="st">"~ ."</span>)),</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dd,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> trained_control,</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneList =</span> <span class="fu">list</span>(</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">ranger =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"ranger"</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">mtry =</span> <span class="dv">12</span>,</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">splitrule =</span> <span class="st">"variance"</span>,</span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.node.size =</span> <span class="dv">5</span></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance =</span> <span class="st">"permutation"</span>,</span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">num.trees =</span> <span class="dv">5000</span></span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">gbm =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"gbm"</span>,</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">n.trees =</span> <span class="dv">300</span>,</span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">interaction.depth =</span> <span class="dv">10</span>,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">shrinkage =</span> <span class="fl">0.1</span>,</span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">n.minobsinnode =</span> <span class="dv">10</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">xgbTree =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"xgbTree"</span>,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">nrounds =</span> <span class="dv">1000</span>,</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">eta =</span> <span class="fl">0.1</span>,</span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_depth =</span> <span class="dv">5</span>,</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">gamma =</span> <span class="dv">0</span>,</span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">colsample_bytree =</span> <span class="fl">0.6</span>,</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">min_child_weight =</span> <span class="dv">1</span>,</span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">subsample =</span> <span class="dv">1</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Summarzize across individual models ========================================#</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create resamples from the list of models</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>resamps_J1 <span class="ot">&lt;-</span> <span class="fu">resamples</span>(modelsList_J1)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resampled error rates for each model</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>dotplot_resamps_J1 <span class="ot">&lt;-</span> <span class="fu">dotplot</span>(resamps_J1)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the resamples</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>summary_resamps_J1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(resamps_J1)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine everything into a list</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>resamples_all_J1 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Jaccard1 =</span> <span class="fu">list</span>(</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamps_J1 =</span> resamps_J1,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dotplot =</span> dotplot_resamps_J1, <span class="co"># store the dotplot object</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Summary =</span> summary_resamps_J1  <span class="co"># store the summary object</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>resamples_all_J1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Jaccard1
$Jaccard1$resamps_J1

Call:
resamples.default(x = modelsList_J1)

Models: ranger, gbm, xgbTree 
Number of resamples: 10 
Performance metrics: MAE, RMSE, Rsquared 
Time estimates for: everything, final model fit 

$Jaccard1$Dotplot</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_FinalModels_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$Jaccard1$Summary

Call:
summary.resamples(object = resamps_J1)

Models: ranger, gbm, xgbTree 
Number of resamples: 10 

MAE 
              Min.    1st Qu.     Median       Mean    3rd Qu.       Max. NA's
ranger  0.06848070 0.07161636 0.07275848 0.07369927 0.07584192 0.08114329    0
gbm     0.06193790 0.07052741 0.07172446 0.07226187 0.07497275 0.08192653    0
xgbTree 0.06261764 0.07024619 0.07146359 0.07133180 0.07190695 0.07887175    0

RMSE 
              Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
ranger  0.09883248 0.1030705 0.1094454 0.1113231 0.1157472 0.1297299    0
gbm     0.09389088 0.1015449 0.1052099 0.1103197 0.1181893 0.1372058    0
xgbTree 0.09516518 0.1021747 0.1034087 0.1084217 0.1145142 0.1314592    0

Rsquared 
             Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
ranger  0.7892004 0.8340418 0.8523348 0.8452701 0.8662831 0.8809218    0
gbm     0.7733919 0.8255792 0.8668470 0.8478966 0.8737032 0.8916121    0
xgbTree 0.7890760 0.8366012 0.8634119 0.8530995 0.8725559 0.8886361    0</code></pre>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Predictive Performance analysis ================================================</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>p_J1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(modelsList_J1, <span class="at">newdata =</span> dd_test)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(dd_test<span class="sc">$</span>Jaccard) <span class="sc">%&gt;%</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_ranger =</span> dd_test<span class="sc">$</span>Jaccard<span class="sc">-</span>ranger,</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_gbm =</span> dd_test<span class="sc">$</span>Jaccard<span class="sc">-</span>gbm,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_xgb =</span> dd_test<span class="sc">$</span>Jaccard<span class="sc">-</span>xgbTree) </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>p_J1 <span class="sc">%&gt;%</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_ranger =</span> <span class="fu">mean</span>(error_ranger),</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_gbm =</span> <span class="fu">mean</span>(error_gbm),</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_xgb =</span> <span class="fu">mean</span>(error_xgb)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>() <span class="co"># ranger performs best</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">mean_ranger</th>
<th style="text-align: right;">mean_gbm</th>
<th style="text-align: right;">mean_xgb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0101863</td>
<td style="text-align: right;">0.016859</td>
<td style="text-align: right;">0.011548</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>The ensemble model is not better than the ranger model alone. In fact, it’s a bit worse. We will discard the ensembleModel approach therefore.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the ensemble model ================================================</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Are they correlated? </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># yes. not the best foundation for ensembleModels...</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">modelCor</span>(<span class="fu">resamples</span>(modelsList_J1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           ranger       gbm   xgbTree
ranger  1.0000000 0.6675497 0.7869473
gbm     0.6675497 1.0000000 0.8179074
xgbTree 0.7869473 0.8179074 1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ensembleModel_J1 <span class="ot">&lt;-</span> <span class="fu">caretEnsemble</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>    modelsList_J1,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"Rsquared"</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> trained_control)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ensembleModel_J1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following models were ensembled: ranger, gbm, xgbTree 
They were weighted: 
-0.0016 0.2234 0.3675 0.4111
The resulting Rsquared is: 0.8392
The fit for each individual model on the Rsquared is: 
  method  Rsquared RsquaredSD
  ranger 0.8452701 0.03151442
     gbm 0.8478966 0.03864407
 xgbTree 0.8530995 0.02992978</code></pre>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize predictor importances ============================================</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(ensembleModel_J1) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(overall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                        overall       ranger          gbm
rel_occ_Ncells                     2.248180e+01 2.110555e+01 21.706537223
AOO                                2.002525e+01 1.613348e+01 19.434330050
moran                              1.105809e+01 1.026658e+01 10.077573258
D_AOO_a                            1.102138e+01 1.625529e+01  9.226284350
rel_relCirc                        4.398900e+00 5.956024e+00  4.990841294
x_intercept                        4.263432e+00 5.348377e+00  4.266148165
mean_prob_cooccur                  4.042548e+00 8.152068e+00  2.595945382
circ                               3.346581e+00 2.752171e+00  4.746038605
GlobRangeSize_m2                   3.321725e+00 1.641687e+00  3.568772501
BetaSR_sp                          2.885173e+00 1.610684e+00  3.847881842
widthMinRect                       2.454478e+00 1.671877e+00  2.836754971
Westernness                        2.029216e+00 9.805118e-01  2.680586625
sp_centr_lon                       1.686130e+00 1.628758e+00  1.357591296
Southernness                       1.629908e+00 9.498427e-01  2.139620060
Dist_centroid_to_COG               1.563904e+00 2.043304e+00  1.470759314
sp_centr_lat                       1.442999e+00 1.915912e+00  1.917358681
AlphaSR_sp                         1.441137e+00 1.132847e+00  2.143360464
HabitatMarine                      2.275902e-01 8.439158e-02  0.251957702
HabitatWetland                     1.653433e-01 6.179756e-02  0.180502399
Trophic.NicheVertivore             9.790925e-02 2.053926e-02  0.121176238
HabitatRock                        9.672362e-02 1.491517e-02  0.084563754
Trophic.NicheOmnivore              6.556258e-02 6.207227e-03  0.108953494
HabitatGrassland                   4.882083e-02 2.025468e-02  0.054308271
HabitatHuman Modified              4.278182e-02 6.039479e-03  0.043946208
Trophic.NicheGranivore             3.786718e-02 1.444022e-02  0.071499196
HabitatForest                      3.416879e-02 5.457398e-02  0.032852854
Trophic.NicheHerbivore terrestrial 2.428075e-02 7.273212e-02  0.000000000
Trophic.NicheInvertivore           2.045985e-02 5.811976e-02  0.012585871
Trophic.NicheHerbivore aquatic     1.553556e-02 8.073846e-03  0.015032065
HabitatWoodland                    1.392963e-02 5.390698e-03  0.010580351
HabitatShrubland                   7.501613e-03 9.869423e-03  0.005657515
Trophic.NicheFrugivore             4.513279e-03 1.527695e-02  0.000000000
HabitatRiverine                    3.820960e-03 0.000000e+00  0.000000000
Trophic.NicheScavenger             2.560277e-04 1.148196e-03  0.000000000
Trophic.NicheNectarivore           1.419716e-04 6.319197e-04  0.000000000
HabitatDesert                      1.409070e-04 6.319197e-04  0.000000000
                                        xgbTree
rel_occ_Ncells                     2.392296e+01
AOO                                2.266889e+01
moran                              1.236493e+01
D_AOO_a                            9.781439e+00
rel_relCirc                        3.023326e+00
x_intercept                        3.671295e+00
mean_prob_cooccur                  3.102192e+00
circ                               2.418494e+00
GlobRangeSize_m2                   4.014017e+00
BetaSR_sp                          2.717204e+00
widthMinRect                       2.538080e+00
Westernness                        2.016874e+00
sp_centr_lon                       2.011041e+00
Southernness                       1.543846e+00
Dist_centroid_to_COG               1.386606e+00
sp_centr_lat                       7.618571e-01
AlphaSR_sp                         9.808885e-01
HabitatMarine                      2.836383e-01
HabitatWetland                     2.080715e-01
Trophic.NicheVertivore             1.191611e-01
HabitatRock                        1.520610e-01
Trophic.NicheOmnivore              5.903117e-02
HabitatGrassland                   5.944161e-02
HabitatHuman Modified              6.171164e-02
Trophic.NicheGranivore             2.053222e-02
HabitatForest                      2.425431e-02
Trophic.NicheHerbivore terrestrial 1.965360e-02
Trophic.NicheInvertivore           7.029942e-03
Trophic.NicheHerbivore aquatic     2.004142e-02
HabitatWoodland                    2.156525e-02
HabitatShrubland                   7.863319e-03
Trophic.NicheFrugivore             2.697880e-03
HabitatRiverine                    9.313886e-03
Trophic.NicheScavenger             0.000000e+00
Trophic.NicheNectarivore           2.594904e-06
HabitatDesert                      0.000000e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ranger</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>imp_ranger <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_J1[[<span class="dv">1</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_ranger"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>imp_ranger<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_ranger)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># gbm</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>imp_gbm <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_J1[[<span class="dv">2</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_gbm"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>imp_gbm<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_gbm)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>imp_merged <span class="ot">&lt;-</span> <span class="fu">merge</span>(imp_ranger, imp_gbm)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># xgb</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>imp_xgb <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_J1[[<span class="dv">3</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_xgb"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>imp_xgb<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_xgb)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>imp_merged_all_J1 <span class="ot">&lt;-</span> <span class="fu">merge</span>(imp_merged, imp_xgb) <span class="sc">%&gt;%</span> </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(imp_ranger))</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>imp_merged_all_J1 <span class="sc">%&gt;%</span> </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 49%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">var</th>
<th style="text-align: right;">imp_ranger</th>
<th style="text-align: right;">imp_gbm</th>
<th style="text-align: right;">imp_xgb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rel_occ_Ncells</td>
<td style="text-align: right;">100.0000000</td>
<td style="text-align: right;">100.0000000</td>
<td style="text-align: right;">100.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">D_AOO_a</td>
<td style="text-align: right;">77.0190099</td>
<td style="text-align: right;">42.5046347</td>
<td style="text-align: right;">40.8872493</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AOO</td>
<td style="text-align: right;">76.4418850</td>
<td style="text-align: right;">89.5321527</td>
<td style="text-align: right;">94.7578766</td>
</tr>
<tr class="even">
<td style="text-align: left;">moran</td>
<td style="text-align: right;">48.6440018</td>
<td style="text-align: right;">46.4264436</td>
<td style="text-align: right;">51.6864475</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean_prob_cooccur</td>
<td style="text-align: right;">38.6252330</td>
<td style="text-align: right;">11.9592792</td>
<td style="text-align: right;">12.9674291</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_relCirc</td>
<td style="text-align: right;">28.2201809</td>
<td style="text-align: right;">22.9923421</td>
<td style="text-align: right;">12.6377599</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x_intercept</td>
<td style="text-align: right;">25.3410933</td>
<td style="text-align: right;">19.6537482</td>
<td style="text-align: right;">15.3463255</td>
</tr>
<tr class="even">
<td style="text-align: left;">circ</td>
<td style="text-align: right;">13.0400334</td>
<td style="text-align: right;">21.8645588</td>
<td style="text-align: right;">10.1095107</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dist_centroid_to_COG</td>
<td style="text-align: right;">9.6813605</td>
<td style="text-align: right;">6.7756515</td>
<td style="text-align: right;">5.7961319</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lat</td>
<td style="text-align: right;">9.0777625</td>
<td style="text-align: right;">8.8330933</td>
<td style="text-align: right;">3.1846275</td>
</tr>
<tr class="odd">
<td style="text-align: left;">widthMinRect</td>
<td style="text-align: right;">7.9215046</td>
<td style="text-align: right;">13.0686666</td>
<td style="text-align: right;">10.6093910</td>
</tr>
<tr class="even">
<td style="text-align: left;">GlobRangeSize_m2</td>
<td style="text-align: right;">7.7784629</td>
<td style="text-align: right;">16.4410033</td>
<td style="text-align: right;">16.7789353</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sp_centr_lon</td>
<td style="text-align: right;">7.7172001</td>
<td style="text-align: right;">6.2542970</td>
<td style="text-align: right;">8.4063232</td>
</tr>
<tr class="even">
<td style="text-align: left;">BetaSR_sp</td>
<td style="text-align: right;">7.6315666</td>
<td style="text-align: right;">17.7268341</td>
<td style="text-align: right;">11.3581454</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AlphaSR_sp</td>
<td style="text-align: right;">5.3675327</td>
<td style="text-align: right;">9.8742625</td>
<td style="text-align: right;">4.1001975</td>
</tr>
<tr class="even">
<td style="text-align: left;">Westernness</td>
<td style="text-align: right;">4.6457531</td>
<td style="text-align: right;">12.3492135</td>
<td style="text-align: right;">8.4307034</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Southernness</td>
<td style="text-align: right;">4.5004405</td>
<td style="text-align: right;">9.8570308</td>
<td style="text-align: right;">6.4534085</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatMarine</td>
<td style="text-align: right;">0.3998549</td>
<td style="text-align: right;">1.1607457</td>
<td style="text-align: right;">1.1856325</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheHerbivore terrestrial</td>
<td style="text-align: right;">0.3446114</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0821537</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatWetland</td>
<td style="text-align: right;">0.2928024</td>
<td style="text-align: right;">0.8315578</td>
<td style="text-align: right;">0.8697565</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheInvertivore</td>
<td style="text-align: right;">0.2753766</td>
<td style="text-align: right;">0.0579819</td>
<td style="text-align: right;">0.0293858</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatForest</td>
<td style="text-align: right;">0.2585764</td>
<td style="text-align: right;">0.1513500</td>
<td style="text-align: right;">0.1013851</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheVertivore</td>
<td style="text-align: right;">0.0973168</td>
<td style="text-align: right;">0.5582477</td>
<td style="text-align: right;">0.4981035</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatGrassland</td>
<td style="text-align: right;">0.0959685</td>
<td style="text-align: right;">0.2501932</td>
<td style="text-align: right;">0.2484710</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheFrugivore</td>
<td style="text-align: right;">0.0723836</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0112774</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatRock</td>
<td style="text-align: right;">0.0706694</td>
<td style="text-align: right;">0.3895774</td>
<td style="text-align: right;">0.6356278</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheGranivore</td>
<td style="text-align: right;">0.0684191</td>
<td style="text-align: right;">0.3293902</td>
<td style="text-align: right;">0.0858264</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatShrubland</td>
<td style="text-align: right;">0.0467622</td>
<td style="text-align: right;">0.0260636</td>
<td style="text-align: right;">0.0328693</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheHerbivore aquatic</td>
<td style="text-align: right;">0.0382546</td>
<td style="text-align: right;">0.0692513</td>
<td style="text-align: right;">0.0837748</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheOmnivore</td>
<td style="text-align: right;">0.0294104</td>
<td style="text-align: right;">0.5019386</td>
<td style="text-align: right;">0.2467553</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatHuman Modified</td>
<td style="text-align: right;">0.0286156</td>
<td style="text-align: right;">0.2024561</td>
<td style="text-align: right;">0.2579599</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatWoodland</td>
<td style="text-align: right;">0.0255416</td>
<td style="text-align: right;">0.0487427</td>
<td style="text-align: right;">0.0901446</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheScavenger</td>
<td style="text-align: right;">0.0054403</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatDesert</td>
<td style="text-align: right;">0.0029941</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheNectarivore</td>
<td style="text-align: right;">0.0029941</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000108</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatRiverine</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0389328</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(ensembleModel_J1) <span class="sc">%&gt;%</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(overall)) <span class="sc">%&gt;%</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 44%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">overall</th>
<th style="text-align: right;">ranger</th>
<th style="text-align: right;">gbm</th>
<th style="text-align: right;">xgbTree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rel_occ_Ncells</td>
<td style="text-align: right;">22.4817990</td>
<td style="text-align: right;">21.1055504</td>
<td style="text-align: right;">21.7065372</td>
<td style="text-align: right;">23.9229568</td>
</tr>
<tr class="even">
<td style="text-align: left;">AOO</td>
<td style="text-align: right;">20.0252534</td>
<td style="text-align: right;">16.1334806</td>
<td style="text-align: right;">19.4343301</td>
<td style="text-align: right;">22.6688859</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moran</td>
<td style="text-align: right;">11.0580908</td>
<td style="text-align: right;">10.2665843</td>
<td style="text-align: right;">10.0775733</td>
<td style="text-align: right;">12.3649265</td>
</tr>
<tr class="even">
<td style="text-align: left;">D_AOO_a</td>
<td style="text-align: right;">11.0213771</td>
<td style="text-align: right;">16.2552860</td>
<td style="text-align: right;">9.2262844</td>
<td style="text-align: right;">9.7814390</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_relCirc</td>
<td style="text-align: right;">4.3989002</td>
<td style="text-align: right;">5.9560245</td>
<td style="text-align: right;">4.9908413</td>
<td style="text-align: right;">3.0233258</td>
</tr>
<tr class="even">
<td style="text-align: left;">x_intercept</td>
<td style="text-align: right;">4.2634317</td>
<td style="text-align: right;">5.3483772</td>
<td style="text-align: right;">4.2661482</td>
<td style="text-align: right;">3.6712948</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean_prob_cooccur</td>
<td style="text-align: right;">4.0425479</td>
<td style="text-align: right;">8.1520680</td>
<td style="text-align: right;">2.5959454</td>
<td style="text-align: right;">3.1021925</td>
</tr>
<tr class="even">
<td style="text-align: left;">circ</td>
<td style="text-align: right;">3.3465813</td>
<td style="text-align: right;">2.7521708</td>
<td style="text-align: right;">4.7460386</td>
<td style="text-align: right;">2.4184939</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GlobRangeSize_m2</td>
<td style="text-align: right;">3.3217251</td>
<td style="text-align: right;">1.6416874</td>
<td style="text-align: right;">3.5687725</td>
<td style="text-align: right;">4.0140175</td>
</tr>
<tr class="even">
<td style="text-align: left;">BetaSR_sp</td>
<td style="text-align: right;">2.8851730</td>
<td style="text-align: right;">1.6106841</td>
<td style="text-align: right;">3.8478818</td>
<td style="text-align: right;">2.7172042</td>
</tr>
<tr class="odd">
<td style="text-align: left;">widthMinRect</td>
<td style="text-align: right;">2.4544782</td>
<td style="text-align: right;">1.6718771</td>
<td style="text-align: right;">2.8367550</td>
<td style="text-align: right;">2.5380800</td>
</tr>
<tr class="even">
<td style="text-align: left;">Westernness</td>
<td style="text-align: right;">2.0292158</td>
<td style="text-align: right;">0.9805118</td>
<td style="text-align: right;">2.6805866</td>
<td style="text-align: right;">2.0168735</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sp_centr_lon</td>
<td style="text-align: right;">1.6861300</td>
<td style="text-align: right;">1.6287576</td>
<td style="text-align: right;">1.3575913</td>
<td style="text-align: right;">2.0110411</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southernness</td>
<td style="text-align: right;">1.6299083</td>
<td style="text-align: right;">0.9498427</td>
<td style="text-align: right;">2.1396201</td>
<td style="text-align: right;">1.5438461</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dist_centroid_to_COG</td>
<td style="text-align: right;">1.5639036</td>
<td style="text-align: right;">2.0433044</td>
<td style="text-align: right;">1.4707593</td>
<td style="text-align: right;">1.3866061</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lat</td>
<td style="text-align: right;">1.4429992</td>
<td style="text-align: right;">1.9159117</td>
<td style="text-align: right;">1.9173587</td>
<td style="text-align: right;">0.7618571</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AlphaSR_sp</td>
<td style="text-align: right;">1.4411374</td>
<td style="text-align: right;">1.1328473</td>
<td style="text-align: right;">2.1433605</td>
<td style="text-align: right;">0.9808885</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatMarine</td>
<td style="text-align: right;">0.2275902</td>
<td style="text-align: right;">0.0843916</td>
<td style="text-align: right;">0.2519577</td>
<td style="text-align: right;">0.2836383</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatWetland</td>
<td style="text-align: right;">0.1653433</td>
<td style="text-align: right;">0.0617976</td>
<td style="text-align: right;">0.1805024</td>
<td style="text-align: right;">0.2080715</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheVertivore</td>
<td style="text-align: right;">0.0979093</td>
<td style="text-align: right;">0.0205393</td>
<td style="text-align: right;">0.1211762</td>
<td style="text-align: right;">0.1191611</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatRock</td>
<td style="text-align: right;">0.0967236</td>
<td style="text-align: right;">0.0149152</td>
<td style="text-align: right;">0.0845638</td>
<td style="text-align: right;">0.1520610</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheOmnivore</td>
<td style="text-align: right;">0.0655626</td>
<td style="text-align: right;">0.0062072</td>
<td style="text-align: right;">0.1089535</td>
<td style="text-align: right;">0.0590312</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatGrassland</td>
<td style="text-align: right;">0.0488208</td>
<td style="text-align: right;">0.0202547</td>
<td style="text-align: right;">0.0543083</td>
<td style="text-align: right;">0.0594416</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatHuman Modified</td>
<td style="text-align: right;">0.0427818</td>
<td style="text-align: right;">0.0060395</td>
<td style="text-align: right;">0.0439462</td>
<td style="text-align: right;">0.0617116</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheGranivore</td>
<td style="text-align: right;">0.0378672</td>
<td style="text-align: right;">0.0144402</td>
<td style="text-align: right;">0.0714992</td>
<td style="text-align: right;">0.0205322</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatForest</td>
<td style="text-align: right;">0.0341688</td>
<td style="text-align: right;">0.0545740</td>
<td style="text-align: right;">0.0328529</td>
<td style="text-align: right;">0.0242543</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheHerbivore terrestrial</td>
<td style="text-align: right;">0.0242807</td>
<td style="text-align: right;">0.0727321</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0196536</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheInvertivore</td>
<td style="text-align: right;">0.0204598</td>
<td style="text-align: right;">0.0581198</td>
<td style="text-align: right;">0.0125859</td>
<td style="text-align: right;">0.0070299</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheHerbivore aquatic</td>
<td style="text-align: right;">0.0155356</td>
<td style="text-align: right;">0.0080738</td>
<td style="text-align: right;">0.0150321</td>
<td style="text-align: right;">0.0200414</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatWoodland</td>
<td style="text-align: right;">0.0139296</td>
<td style="text-align: right;">0.0053907</td>
<td style="text-align: right;">0.0105804</td>
<td style="text-align: right;">0.0215653</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatShrubland</td>
<td style="text-align: right;">0.0075016</td>
<td style="text-align: right;">0.0098694</td>
<td style="text-align: right;">0.0056575</td>
<td style="text-align: right;">0.0078633</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheFrugivore</td>
<td style="text-align: right;">0.0045133</td>
<td style="text-align: right;">0.0152769</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0026979</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatRiverine</td>
<td style="text-align: right;">0.0038210</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0093139</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheScavenger</td>
<td style="text-align: right;">0.0002560</td>
<td style="text-align: right;">0.0011482</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheNectarivore</td>
<td style="text-align: right;">0.0001420</td>
<td style="text-align: right;">0.0006319</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000026</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatDesert</td>
<td style="text-align: right;">0.0001409</td>
<td style="text-align: right;">0.0006319</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(response, predictors, index, dd, dd_test, trained_control)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J1: 43.97 sec elapsed</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="jaccard-2" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Jaccard 2</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Train model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">Summarize individual models</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">Predictive performances</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">Ensemble model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">Summarize predictor importances</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>(<span class="st">"J2"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define model variables  (response, indices and predictors)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="st">"Jaccard"</span> <span class="co"># Replace with your actual response variable name</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> reduced_predictors[[<span class="dv">2</span>]] <span class="co"># Replace with your actual predictors</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> indices_J2</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> dat_train_J2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(response, predictors)))</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>dd_test <span class="ot">&lt;-</span> dat_test_J2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(response, predictors)))</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define training control</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>trained_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">savePredictions =</span> <span class="st">"final"</span>,</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">returnResamp =</span> <span class="st">"final"</span>,</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">verboseIter =</span> <span class="cn">FALSE</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> index <span class="co"># Ensure indices_J2 is defined</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Train all models at once using caretList / using bestFit hyperparameters from 03_HyperparameterTuning.qmd</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>modelsList_J2 <span class="ot">&lt;-</span> <span class="fu">caretList</span>(</span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.formula</span>(<span class="fu">paste</span>(response, <span class="st">"~ ."</span>)),</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dd,</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> trained_control,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneList =</span> <span class="fu">list</span>(</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">ranger =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"ranger"</span>,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">mtry =</span> <span class="dv">5</span>,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">splitrule =</span> <span class="st">"variance"</span>,</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.node.size =</span> <span class="dv">5</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance =</span> <span class="st">"permutation"</span>,</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">num.trees =</span> <span class="dv">5000</span></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">gbm =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"gbm"</span>,</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n.trees =</span> <span class="dv">50</span>,</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">interaction.depth =</span> <span class="dv">9</span>,</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">shrinkage =</span> <span class="fl">0.1</span>,</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">n.minobsinnode =</span> <span class="dv">10</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">xgbTree =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"xgbTree"</span>,</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">nrounds =</span> <span class="dv">1000</span>,</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">eta =</span> <span class="fl">0.1</span>,</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_depth =</span> <span class="dv">5</span>,</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">gamma =</span> <span class="fl">0.01</span>,</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">colsample_bytree =</span> <span class="fl">0.6</span>,</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">min_child_weight =</span> <span class="dv">1</span>,</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">subsample =</span> <span class="dv">1</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-61"><a href="#cb19-61" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Summarzize across individual models ========================================#</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create resamples from the list of models</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>resamps_J2 <span class="ot">&lt;-</span> <span class="fu">resamples</span>(modelsList_J2)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resampled error rates for each model</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>dotplot_resamps_J2 <span class="ot">&lt;-</span> <span class="fu">dotplot</span>(resamps_J2)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the resamples</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>summary_resamps_J2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(resamps_J2)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine everything into a list</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>resamples_all_J2 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Jaccard1 =</span> <span class="fu">list</span>(</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamps_J2 =</span> resamps_J2,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dotplot =</span> dotplot_resamps_J2, <span class="co"># store the dotplot object</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Summary =</span> summary_resamps_J2  <span class="co"># store the summary object</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>resamples_all_J2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Jaccard1
$Jaccard1$resamps_J2

Call:
resamples.default(x = modelsList_J2)

Models: ranger, gbm, xgbTree 
Number of resamples: 10 
Performance metrics: MAE, RMSE, Rsquared 
Time estimates for: everything, final model fit 

$Jaccard1$Dotplot</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_FinalModels_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$Jaccard1$Summary

Call:
summary.resamples(object = resamps_J2)

Models: ranger, gbm, xgbTree 
Number of resamples: 10 

MAE 
              Min.    1st Qu.     Median       Mean    3rd Qu.       Max. NA's
ranger  0.07893954 0.08245473 0.08522723 0.08620569 0.09027565 0.09796493    0
gbm     0.08389465 0.08534676 0.08913508 0.08927248 0.09162794 0.09938889    0
xgbTree 0.07828025 0.08270763 0.08399418 0.08554858 0.08843030 0.09721043    0

RMSE 
             Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
ranger  0.1125653 0.1196879 0.1236389 0.1242638 0.1279999 0.1374080    0
gbm     0.1160564 0.1262113 0.1295391 0.1298688 0.1337012 0.1443002    0
xgbTree 0.1070532 0.1200788 0.1231785 0.1241742 0.1284834 0.1421728    0

Rsquared 
             Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
ranger  0.7596017 0.7986473 0.8135708 0.8094090 0.8247881 0.8450611    0
gbm     0.7452297 0.7801081 0.7952683 0.7913620 0.8032783 0.8335825    0
xgbTree 0.7452082 0.8023182 0.8120472 0.8095943 0.8232890 0.8584104    0</code></pre>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Predictive Performance analysis ================================================</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>p_J2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(modelsList_J2, <span class="at">newdata =</span> dd_test)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(dd_test<span class="sc">$</span>Jaccard) <span class="sc">%&gt;%</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_ranger =</span> dd_test<span class="sc">$</span>Jaccard<span class="sc">-</span>ranger,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_gbm =</span> dd_test<span class="sc">$</span>Jaccard<span class="sc">-</span>gbm,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_xgb =</span> dd_test<span class="sc">$</span>Jaccard<span class="sc">-</span>xgbTree) </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>p_J2 <span class="sc">%&gt;%</span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_ranger =</span> <span class="fu">mean</span>(error_ranger),</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_gbm =</span> <span class="fu">mean</span>(error_gbm),</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_xgb =</span> <span class="fu">mean</span>(error_xgb)) <span class="sc">%&gt;%</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>() <span class="co"># ranger performs best</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">mean_ranger</th>
<th style="text-align: right;">mean_gbm</th>
<th style="text-align: right;">mean_xgb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0058978</td>
<td style="text-align: right;">0.0050606</td>
<td style="text-align: right;">0.0086411</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>The ensemble model is not better than the ranger model alone. In fact, it’s a bit worse. We will discard the ensembleModel approach therefore.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the ensemble model ================================================</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Are they correlated? </span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># yes. not the best foundation for ensembleModels...</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">modelCor</span>(<span class="fu">resamples</span>(modelsList_J2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           ranger       gbm   xgbTree
ranger  1.0000000 0.7087220 0.8517862
gbm     0.7087220 1.0000000 0.4165927
xgbTree 0.8517862 0.4165927 1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ensembleModel_J2 <span class="ot">&lt;-</span> <span class="fu">caretEnsemble</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    modelsList_J2,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"Rsquared"</span>,</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> trained_control)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ensembleModel_J2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following models were ensembled: ranger, gbm, xgbTree 
They were weighted: 
0.0023 0.5489 -0.0384 0.4971
The resulting Rsquared is: 0.7829
The fit for each individual model on the Rsquared is: 
  method  Rsquared RsquaredSD
  ranger 0.8094090 0.02414369
     gbm 0.7913620 0.02385256
 xgbTree 0.8095943 0.02903417</code></pre>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize predictor importances ============================================</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(ensembleModel_J2) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(overall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        overall     ranger         gbm     xgbTree
rel_occ_Ncells       36.2019483 30.6406770 30.71455254 42.76746759
moran                14.5230983 11.7475052 15.68934146 17.49812317
AOO                  14.4724987 14.5848535 19.01366798 13.99747404
D_AOO_a              11.1558704 15.6942177 12.99614943  6.00184528
x_intercept           7.6943735  8.6705150  3.71501500  6.92392805
rel_relCirc           3.3348299  5.6113834  1.42842448  0.96810732
BetaSR_sp             3.0263428  1.9812211  3.29259704  4.15991907
circ                  2.2519701  2.4568247  4.36127472  1.86273389
Dist_centroid_to_COG  2.2420879  3.0571749  1.45380682  1.40288744
sp_centr_lon          1.3496431  1.6783866  0.04228594  1.08763841
Westernness           1.1948897  1.0428352  2.18772009  1.28607963
sp_centr_lat          0.9334169  1.7845072  0.84979502  0.00000000
GlobRangeSize_m2      0.8929399  0.0000000  2.33714816  1.76742422
AlphaSR_sp            0.5836263  0.8246285  1.91822133  0.21434225
Southernness          0.1424642  0.2252700  0.00000000  0.06202963</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ranger</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>imp_ranger <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_J2[[<span class="dv">1</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_ranger"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>imp_ranger<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_ranger)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># gbm</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>imp_gbm <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_J2[[<span class="dv">2</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_gbm"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>imp_gbm<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_gbm)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>imp_merged <span class="ot">&lt;-</span> <span class="fu">merge</span>(imp_ranger, imp_gbm)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># xgb</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>imp_xgb <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_J2[[<span class="dv">3</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_xgb"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>imp_xgb<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_xgb)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>imp_merged_all_J2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(imp_merged, imp_xgb) <span class="sc">%&gt;%</span> </span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(imp_ranger))</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>imp_merged_all_J2 <span class="sc">%&gt;%</span> </span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">var</th>
<th style="text-align: right;">imp_ranger</th>
<th style="text-align: right;">imp_gbm</th>
<th style="text-align: right;">imp_xgb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rel_occ_Ncells</td>
<td style="text-align: right;">100.0000000</td>
<td style="text-align: right;">100.000000</td>
<td style="text-align: right;">100.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">D_AOO_a</td>
<td style="text-align: right;">51.2202053</td>
<td style="text-align: right;">42.312677</td>
<td style="text-align: right;">14.0336700</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AOO</td>
<td style="text-align: right;">47.5996451</td>
<td style="text-align: right;">61.904428</td>
<td style="text-align: right;">32.7292562</td>
</tr>
<tr class="even">
<td style="text-align: left;">moran</td>
<td style="text-align: right;">38.3395744</td>
<td style="text-align: right;">51.081133</td>
<td style="text-align: right;">40.9145646</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x_intercept</td>
<td style="text-align: right;">28.2974002</td>
<td style="text-align: right;">12.095293</td>
<td style="text-align: right;">16.1897078</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_relCirc</td>
<td style="text-align: right;">18.3135100</td>
<td style="text-align: right;">4.650644</td>
<td style="text-align: right;">2.2636536</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dist_centroid_to_COG</td>
<td style="text-align: right;">9.9775044</td>
<td style="text-align: right;">4.733283</td>
<td style="text-align: right;">3.2802677</td>
</tr>
<tr class="even">
<td style="text-align: left;">circ</td>
<td style="text-align: right;">8.0181802</td>
<td style="text-align: right;">14.199376</td>
<td style="text-align: right;">4.3554926</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BetaSR_sp</td>
<td style="text-align: right;">6.4659834</td>
<td style="text-align: right;">10.719990</td>
<td style="text-align: right;">9.7268305</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lat</td>
<td style="text-align: right;">5.8239809</td>
<td style="text-align: right;">2.766750</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sp_centr_lon</td>
<td style="text-align: right;">5.4776421</td>
<td style="text-align: right;">0.137674</td>
<td style="text-align: right;">2.5431443</td>
</tr>
<tr class="even">
<td style="text-align: left;">Westernness</td>
<td style="text-align: right;">3.4034338</td>
<td style="text-align: right;">7.122748</td>
<td style="text-align: right;">3.0071447</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AlphaSR_sp</td>
<td style="text-align: right;">2.6912868</td>
<td style="text-align: right;">6.245317</td>
<td style="text-align: right;">0.5011806</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southernness</td>
<td style="text-align: right;">0.7351993</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.1450393</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GlobRangeSize_m2</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">7.609254</td>
<td style="text-align: right;">4.1326371</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(ensembleModel_J2) <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(overall)) <span class="sc">%&gt;%</span> </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">overall</th>
<th style="text-align: right;">ranger</th>
<th style="text-align: right;">gbm</th>
<th style="text-align: right;">xgbTree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">rel_occ_Ncells</td>
<td style="text-align: right;">36.2019483</td>
<td style="text-align: right;">30.6406770</td>
<td style="text-align: right;">30.7145525</td>
<td style="text-align: right;">42.7674676</td>
</tr>
<tr class="even">
<td style="text-align: left;">moran</td>
<td style="text-align: right;">14.5230983</td>
<td style="text-align: right;">11.7475052</td>
<td style="text-align: right;">15.6893415</td>
<td style="text-align: right;">17.4981232</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AOO</td>
<td style="text-align: right;">14.4724987</td>
<td style="text-align: right;">14.5848535</td>
<td style="text-align: right;">19.0136680</td>
<td style="text-align: right;">13.9974740</td>
</tr>
<tr class="even">
<td style="text-align: left;">D_AOO_a</td>
<td style="text-align: right;">11.1558704</td>
<td style="text-align: right;">15.6942177</td>
<td style="text-align: right;">12.9961494</td>
<td style="text-align: right;">6.0018453</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x_intercept</td>
<td style="text-align: right;">7.6943735</td>
<td style="text-align: right;">8.6705150</td>
<td style="text-align: right;">3.7150150</td>
<td style="text-align: right;">6.9239281</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_relCirc</td>
<td style="text-align: right;">3.3348299</td>
<td style="text-align: right;">5.6113834</td>
<td style="text-align: right;">1.4284245</td>
<td style="text-align: right;">0.9681073</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BetaSR_sp</td>
<td style="text-align: right;">3.0263428</td>
<td style="text-align: right;">1.9812211</td>
<td style="text-align: right;">3.2925970</td>
<td style="text-align: right;">4.1599191</td>
</tr>
<tr class="even">
<td style="text-align: left;">circ</td>
<td style="text-align: right;">2.2519701</td>
<td style="text-align: right;">2.4568247</td>
<td style="text-align: right;">4.3612747</td>
<td style="text-align: right;">1.8627339</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dist_centroid_to_COG</td>
<td style="text-align: right;">2.2420879</td>
<td style="text-align: right;">3.0571749</td>
<td style="text-align: right;">1.4538068</td>
<td style="text-align: right;">1.4028874</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lon</td>
<td style="text-align: right;">1.3496431</td>
<td style="text-align: right;">1.6783866</td>
<td style="text-align: right;">0.0422859</td>
<td style="text-align: right;">1.0876384</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Westernness</td>
<td style="text-align: right;">1.1948897</td>
<td style="text-align: right;">1.0428352</td>
<td style="text-align: right;">2.1877201</td>
<td style="text-align: right;">1.2860796</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lat</td>
<td style="text-align: right;">0.9334169</td>
<td style="text-align: right;">1.7845072</td>
<td style="text-align: right;">0.8497950</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GlobRangeSize_m2</td>
<td style="text-align: right;">0.8929399</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">2.3371482</td>
<td style="text-align: right;">1.7674242</td>
</tr>
<tr class="even">
<td style="text-align: left;">AlphaSR_sp</td>
<td style="text-align: right;">0.5836263</td>
<td style="text-align: right;">0.8246285</td>
<td style="text-align: right;">1.9182213</td>
<td style="text-align: right;">0.2143422</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Southernness</td>
<td style="text-align: right;">0.1424642</td>
<td style="text-align: right;">0.2252700</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0620296</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(response, predictors, index, dd, dd_test, trained_control)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J2: 49.2 sec elapsed</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="log-ratio-1" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Log Ratio 1</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Train model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Summarize individual models</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Predictive performances</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">Ensemble model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">Summarize predictor importances</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>(<span class="st">"LR1"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define model variables  (response, indices and predictors)</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="st">"log_R2_1"</span> </span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> reduced_predictors[[<span class="dv">3</span>]] <span class="co"># Replace with your actual predictors</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> indices_LR1</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> dat_train_LR1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(response, predictors)))</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>dd_test <span class="ot">&lt;-</span> dat_test_LR1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(response, predictors)))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Define training control</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>trained_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">savePredictions =</span> <span class="st">"final"</span>,</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">returnResamp =</span> <span class="st">"final"</span>,</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">verboseIter =</span> <span class="cn">FALSE</span>,</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> index <span class="co"># Ensure indices_LR1 is defined</span></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Train all models at once using caretList / using bestFit hyperparameters from 03_HyperparameterTuning.qmd</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>modelsList_LR1 <span class="ot">&lt;-</span> <span class="fu">caretList</span>(</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.formula</span>(<span class="fu">paste</span>(response, <span class="st">"~ ."</span>)),</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dd,</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> trained_control,</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneList =</span> <span class="fu">list</span>(</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">ranger =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"ranger"</span>,</span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">mtry =</span> <span class="dv">28</span>,</span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">splitrule =</span> <span class="st">"extratrees"</span>,</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.node.size =</span> <span class="dv">5</span></span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance =</span> <span class="st">"permutation"</span>,</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">num.trees =</span> <span class="dv">5000</span></span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">gbm =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"gbm"</span>,</span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">n.trees =</span> <span class="dv">50</span>,</span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">interaction.depth =</span> <span class="dv">3</span>,</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">shrinkage =</span> <span class="fl">0.1</span>,</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">n.minobsinnode =</span> <span class="dv">10</span></span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">xgbTree =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"xgbTree"</span>,</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">nrounds =</span> <span class="dv">1000</span>,</span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">eta =</span> <span class="fl">0.1</span>,</span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_depth =</span> <span class="dv">5</span>,</span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">gamma =</span> <span class="fl">0.1</span>,</span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">colsample_bytree =</span> <span class="fl">0.6</span>,</span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">min_child_weight =</span> <span class="dv">1</span>,</span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">subsample =</span> <span class="dv">1</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Summarzize across individual models ========================================#</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create resamples from the list of models</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>resamps_LR1 <span class="ot">&lt;-</span> <span class="fu">resamples</span>(modelsList_LR1)</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resampled error rates for each model</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>dotplot_resamps_LR1 <span class="ot">&lt;-</span> <span class="fu">dotplot</span>(resamps_LR1)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the resamples</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>summary_resamps_LR1 <span class="ot">&lt;-</span> <span class="fu">summary</span>(resamps_LR1)</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine everything into a list</span></span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>resamples_all_LR1 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb35-14"><a href="#cb35-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Jaccard1 =</span> <span class="fu">list</span>(</span>
<span id="cb35-15"><a href="#cb35-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamps_LR1 =</span> resamps_LR1,</span>
<span id="cb35-16"><a href="#cb35-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dotplot =</span> dotplot_resamps_LR1, <span class="co"># store the dotplot object</span></span>
<span id="cb35-17"><a href="#cb35-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Summary =</span> summary_resamps_LR1  <span class="co"># store the summary object</span></span>
<span id="cb35-18"><a href="#cb35-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb35-19"><a href="#cb35-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-20"><a href="#cb35-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-21"><a href="#cb35-21" aria-hidden="true" tabindex="-1"></a>resamples_all_LR1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Jaccard1
$Jaccard1$resamps_LR1

Call:
resamples.default(x = modelsList_LR1)

Models: ranger, gbm, xgbTree 
Number of resamples: 10 
Performance metrics: MAE, RMSE, Rsquared 
Time estimates for: everything, final model fit 

$Jaccard1$Dotplot</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_FinalModels_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$Jaccard1$Summary

Call:
summary.resamples(object = resamps_LR1)

Models: ranger, gbm, xgbTree 
Number of resamples: 10 

MAE 
             Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
ranger  0.2413500 0.2937891 0.3140971 0.3116381 0.3342397 0.3570233    0
gbm     0.2710595 0.3091150 0.3297544 0.3314569 0.3629118 0.3787333    0
xgbTree 0.2678089 0.3158956 0.3447055 0.3388593 0.3634772 0.3886261    0

RMSE 
             Min.   1st Qu.    Median      Mean  3rd Qu.      Max. NA's
ranger  0.3800898 0.4863429 0.5411437 0.5204904 0.567322 0.5983651    0
gbm     0.4270322 0.5232623 0.5484819 0.5442317 0.591902 0.6322296    0
xgbTree 0.4088023 0.5069973 0.5762541 0.5487222 0.588816 0.6293142    0

Rsquared 
              Min.    1st Qu.    Median      Mean   3rd Qu.      Max. NA's
ranger  0.11579499 0.12877743 0.1775331 0.1901280 0.2192717 0.3722954    0
gbm     0.06093550 0.09401116 0.1100171 0.1218121 0.1493415 0.1882298    0
xgbTree 0.04937369 0.08174521 0.1328073 0.1371819 0.1948978 0.2253123    0</code></pre>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Predictive Performance analysis ================================================</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>p_LR1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(modelsList_LR1, <span class="at">newdata =</span> dd_test)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(dd_test<span class="sc">$</span>log_R2_1) <span class="sc">%&gt;%</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_ranger =</span> dd_test<span class="sc">$</span>log_R2_1<span class="sc">-</span>ranger,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_gbm =</span> dd_test<span class="sc">$</span>log_R2_1<span class="sc">-</span>gbm,</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_xgb =</span> dd_test<span class="sc">$</span>log_R2_1<span class="sc">-</span>xgbTree) </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>p_LR1 <span class="sc">%&gt;%</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_ranger =</span> <span class="fu">mean</span>(error_ranger),</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_gbm =</span> <span class="fu">mean</span>(error_gbm),</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_xgb =</span> <span class="fu">mean</span>(error_xgb)) <span class="sc">%&gt;%</span> </span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>() <span class="co"># ranger performs best</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">mean_ranger</th>
<th style="text-align: right;">mean_gbm</th>
<th style="text-align: right;">mean_xgb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0172756</td>
<td style="text-align: right;">0.0109739</td>
<td style="text-align: right;">0.0058452</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<p>The ensemble model is not better than the ranger model alone. In fact, it’s a bit worse. We will discard the ensembleModel approach therefore.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the ensemble model ================================================</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Are they correlated? </span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># yes. not the best foundation for ensembleModels...</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">modelCor</span>(<span class="fu">resamples</span>(modelsList_LR1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           ranger       gbm   xgbTree
ranger  1.0000000 0.9515691 0.9546465
gbm     0.9515691 1.0000000 0.8665197
xgbTree 0.9546465 0.8665197 1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>ensembleModel_LR1 <span class="ot">&lt;-</span> <span class="fu">caretEnsemble</span>(</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    modelsList_LR1,</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"Rsquared"</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> trained_control)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ensembleModel_LR1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following models were ensembled: ranger, gbm, xgbTree 
They were weighted: 
-0.0066 0.9729 -0.0139 0.0855
The resulting Rsquared is: 0.1385
The fit for each individual model on the Rsquared is: 
  method  Rsquared RsquaredSD
  ranger 0.1901280 0.07840451
     gbm 0.1218121 0.04182013
 xgbTree 0.1371819 0.06528472</code></pre>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize predictor importances ============================================</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(ensembleModel_LR1) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(overall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                      overall    ranger        gbm      xgbTree
D_AOO_a                            9.92796190 9.5125401 17.6939777 13.389344574
AlphaSR_sp                         6.53972184 6.8849653  3.5110932  3.105305597
datasetBirds_atlas_EBBA            5.43632515 5.9892959  0.0000000  0.030802850
sp_centr_lon                       5.01193330 5.0209245  2.8419212  5.262995161
datasetBirds_atlas_Japan           4.35874122 4.8042735  0.0000000  0.000000000
rel_maxDist                        4.13658749 4.4315410  2.6906313  1.016571970
rel_relCirc                        3.55247066 3.5897738  2.5687553  3.288281596
Southernness                       3.23045741 3.2113260  6.9748939  2.838385915
x_intercept                        3.06405924 3.2832897  0.0000000  1.068967617
atlas_widthMinRect                 2.87253860 3.1661575  0.0000000  0.000000000
Westernness                        2.86117464 2.7297333  5.5838645  3.913142173
IUCNLC                             2.77972052 2.8741805  2.8029165  1.701343282
moran                              2.58251295 2.6188672  1.3193391  2.374623255
rel_lin                            2.47062581 2.4453067  2.4518271  2.761723418
rel_occ_Ncells                     2.42794896 2.1626926  4.7955967  5.060040431
Mass                               2.25245665 1.9218254  7.2411481  5.201479609
bearing                            2.00633888 1.8148656  4.5973882  3.762679117
sp_centr_lat                       2.00613316 1.7792523  1.8881329  4.606399427
bearingMinRect                     1.72744509 1.7548552  0.0000000  1.696904740
AOO                                1.66650692 1.3428689  8.1896334  4.286117740
widthMinRect                       1.66589869 1.6437852  3.3059001  1.650422700
datasetBirds_Atlas_New_York        1.66445165 1.8345849  0.0000000  0.000000000
rel_elonRatio                      1.64358544 1.5955601  0.5034746  2.375579893
Dist_centroid_to_COG               1.62024031 1.5643364  0.6457174  2.414900853
BetaSR_sp                          1.59513558 1.4789963  0.5894578  3.080120839
mean_prob_cooccur                  1.44898326 1.1829119  5.9389917  3.744758428
elonMinRect                        1.43179117 1.4384167  0.9720997  1.431269666
minDist_toBorder_centr             1.39700803 1.2755075  3.0815177  2.504935835
atlas_bearingMinRect               1.35201521 1.4902126  0.0000000  0.000000000
Habitat.Density3                   1.10167421 1.1632302  0.0000000  0.580786379
HabitatGrassland                   1.02456017 1.0565355  1.4488756  0.591708231
Hand.Wing.Index                    1.00600016 0.7362298  1.8227244  3.941984932
HabitatWetland                     0.97933179 1.0780781  0.0000000  0.015436564
circ                               0.94470115 0.9094419  1.2715356  1.292599300
GlobRangeSize_m2                   0.67365596 0.5448102  0.0000000  2.249129405
HabitatForest                      0.67298780 0.7394525  0.0000000  0.026453655
sd_PC1                             0.60906604 0.5440202  2.4906645  1.042658246
IUCNNT                             0.59282497 0.6197400  0.4066598  0.316946398
sd_PC2                             0.56301281 0.3820564  0.9381582  2.560531108
Trophic.NicheHerbivore aquatic     0.56253720 0.6196526  0.0000000  0.004377156
Migration2                         0.54222314 0.5632685  0.0000000  0.391097592
Primary.LifestyleInsessorial       0.53676831 0.5847717  0.0000000  0.078072895
Trophic.NicheInvertivore           0.49764479 0.5349728  0.0000000  0.154025120
HabitatShrubland                   0.46430598 0.4025983  0.0000000  1.241911677
Trophic.NicheOmnivore              0.41731930 0.3897340  0.0000000  0.799089825
Migration3                         0.40254520 0.4416751  0.0000000  0.022941191
HabitatHuman Modified              0.32181457 0.3512523  0.0000000  0.039325207
Habitat.Density2                   0.32060259 0.3326944  0.0000000  0.235247461
HabitatMarine                      0.29684975 0.3212837  0.0000000  0.067220270
FP                                 0.28774979 0.2145901  1.0180569  1.001115260
HabitatWoodland                    0.28528631 0.3109020  0.0000000  0.040329478
Primary.LifestyleAquatic           0.28125193 0.2910131  0.0000000  0.216003072
Primary.LifestyleGeneralist        0.26999177 0.2665376  0.4150469  0.285667548
Trophic.NicheVertivore             0.22584250 0.2461183  0.0000000  0.031953982
IUCNVU                             0.19730800 0.2174760  0.0000000  0.000000000
Primary.LifestyleTerrestrial       0.18446233 0.1907955  0.0000000  0.142451255
HabitatRock                        0.15663099 0.1726412  0.0000000  0.000000000
Trophic.NicheScavenger             0.12566534 0.1385103  0.0000000  0.000000000
IUCNEN                             0.12472239 0.1374710  0.0000000  0.000000000
Trophic.NicheFrugivore             0.12273794 0.1352837  0.0000000  0.000000000
Trophic.NicheNectarivore           0.12261071 0.1351435  0.0000000  0.000000000
HabitatDesert                      0.12261071 0.1351435  0.0000000  0.000000000
Trophic.NicheGranivore             0.11858435 0.1283351  0.0000000  0.026966820
HabitatRiverine                    0.11040863 0.1216941  0.0000000  0.000000000
Trophic.NicheHerbivore terrestrial 0.00294067 0.0000000  0.0000000  0.036873286</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ranger</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>imp_ranger <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_LR1[[<span class="dv">1</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_ranger"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>imp_ranger<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_ranger)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># gbm</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>imp_gbm <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_LR1[[<span class="dv">2</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_gbm"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>imp_gbm<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_gbm)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>imp_merged <span class="ot">&lt;-</span> <span class="fu">merge</span>(imp_ranger, imp_gbm)</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="co"># xgb</span></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>imp_xgb <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_LR1[[<span class="dv">3</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_xgb"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>imp_xgb<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_xgb)</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>imp_merged_all_LR1 <span class="ot">&lt;-</span> <span class="fu">merge</span>(imp_merged, imp_xgb) <span class="sc">%&gt;%</span> </span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(imp_ranger))</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>imp_merged_all_LR1 <span class="sc">%&gt;%</span> </span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">var</th>
<th style="text-align: right;">imp_ranger</th>
<th style="text-align: right;">imp_gbm</th>
<th style="text-align: right;">imp_xgb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">D_AOO_a</td>
<td style="text-align: right;">100.000000</td>
<td style="text-align: right;">100.000000</td>
<td style="text-align: right;">100.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">AlphaSR_sp</td>
<td style="text-align: right;">72.377780</td>
<td style="text-align: right;">19.843436</td>
<td style="text-align: right;">23.1923645</td>
</tr>
<tr class="odd">
<td style="text-align: left;">datasetBirds_atlas_EBBA</td>
<td style="text-align: right;">62.962110</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.2300549</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lon</td>
<td style="text-align: right;">52.782164</td>
<td style="text-align: right;">16.061517</td>
<td style="text-align: right;">39.3073397</td>
</tr>
<tr class="odd">
<td style="text-align: left;">datasetBirds_atlas_Japan</td>
<td style="text-align: right;">50.504634</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_maxDist</td>
<td style="text-align: right;">46.586306</td>
<td style="text-align: right;">15.206481</td>
<td style="text-align: right;">7.5923953</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_relCirc</td>
<td style="text-align: right;">37.737279</td>
<td style="text-align: right;">14.517682</td>
<td style="text-align: right;">24.5589437</td>
</tr>
<tr class="even">
<td style="text-align: left;">x_intercept</td>
<td style="text-align: right;">34.515383</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">7.9837188</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Southernness</td>
<td style="text-align: right;">33.758870</td>
<td style="text-align: right;">39.419592</td>
<td style="text-align: right;">21.1988414</td>
</tr>
<tr class="even">
<td style="text-align: left;">atlas_widthMinRect</td>
<td style="text-align: right;">33.284038</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUCNLC</td>
<td style="text-align: right;">30.214648</td>
<td style="text-align: right;">15.841076</td>
<td style="text-align: right;">12.7066958</td>
</tr>
<tr class="even">
<td style="text-align: left;">Westernness</td>
<td style="text-align: right;">28.696155</td>
<td style="text-align: right;">31.557994</td>
<td style="text-align: right;">29.2257933</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moran</td>
<td style="text-align: right;">27.530683</td>
<td style="text-align: right;">7.456430</td>
<td style="text-align: right;">17.7351717</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_lin</td>
<td style="text-align: right;">25.706138</td>
<td style="text-align: right;">13.856845</td>
<td style="text-align: right;">20.6262779</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_occ_Ncells</td>
<td style="text-align: right;">22.735175</td>
<td style="text-align: right;">27.102988</td>
<td style="text-align: right;">37.7915469</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mass</td>
<td style="text-align: right;">20.203072</td>
<td style="text-align: right;">40.924366</td>
<td style="text-align: right;">38.8479031</td>
</tr>
<tr class="odd">
<td style="text-align: left;">datasetBirds_Atlas_New_York</td>
<td style="text-align: right;">19.285963</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">bearing</td>
<td style="text-align: right;">19.078665</td>
<td style="text-align: right;">25.982785</td>
<td style="text-align: right;">28.1020411</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sp_centr_lat</td>
<td style="text-align: right;">18.704282</td>
<td style="text-align: right;">10.671048</td>
<td style="text-align: right;">34.4034721</td>
</tr>
<tr class="even">
<td style="text-align: left;">bearingMinRect</td>
<td style="text-align: right;">18.447809</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">12.6735460</td>
</tr>
<tr class="odd">
<td style="text-align: left;">widthMinRect</td>
<td style="text-align: right;">17.280192</td>
<td style="text-align: right;">18.683759</td>
<td style="text-align: right;">12.3263890</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_elonRatio</td>
<td style="text-align: right;">16.773229</td>
<td style="text-align: right;">2.845458</td>
<td style="text-align: right;">17.7423165</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dist_centroid_to_COG</td>
<td style="text-align: right;">16.444991</td>
<td style="text-align: right;">3.649362</td>
<td style="text-align: right;">18.0359900</td>
</tr>
<tr class="even">
<td style="text-align: left;">atlas_bearingMinRect</td>
<td style="text-align: right;">15.665769</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BetaSR_sp</td>
<td style="text-align: right;">15.547859</td>
<td style="text-align: right;">3.331404</td>
<td style="text-align: right;">23.0042690</td>
</tr>
<tr class="even">
<td style="text-align: left;">elonMinRect</td>
<td style="text-align: right;">15.121269</td>
<td style="text-align: right;">5.493958</td>
<td style="text-align: right;">10.6896171</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AOO</td>
<td style="text-align: right;">14.116827</td>
<td style="text-align: right;">46.284863</td>
<td style="text-align: right;">32.0114082</td>
</tr>
<tr class="even">
<td style="text-align: left;">minDist_toBorder_centr</td>
<td style="text-align: right;">13.408695</td>
<td style="text-align: right;">17.415630</td>
<td style="text-align: right;">18.7084276</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mean_prob_cooccur</td>
<td style="text-align: right;">12.435289</td>
<td style="text-align: right;">33.565045</td>
<td style="text-align: right;">27.9681982</td>
</tr>
<tr class="even">
<td style="text-align: left;">Habitat.Density3</td>
<td style="text-align: right;">12.228387</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">4.3376759</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatWetland</td>
<td style="text-align: right;">11.333230</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.1152899</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatGrassland</td>
<td style="text-align: right;">11.106766</td>
<td style="text-align: right;">8.188524</td>
<td style="text-align: right;">4.4192472</td>
</tr>
<tr class="odd">
<td style="text-align: left;">circ</td>
<td style="text-align: right;">9.560453</td>
<td style="text-align: right;">7.186262</td>
<td style="text-align: right;">9.6539401</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatForest</td>
<td style="text-align: right;">7.773449</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.1975724</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Hand.Wing.Index</td>
<td style="text-align: right;">7.739571</td>
<td style="text-align: right;">10.301383</td>
<td style="text-align: right;">29.4412091</td>
</tr>
<tr class="even">
<td style="text-align: left;">IUCNNT</td>
<td style="text-align: right;">6.514979</td>
<td style="text-align: right;">2.298295</td>
<td style="text-align: right;">2.3671539</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheHerbivore aquatic</td>
<td style="text-align: right;">6.514061</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0326913</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary.LifestyleInsessorial</td>
<td style="text-align: right;">6.147377</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.5830972</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Migration2</td>
<td style="text-align: right;">5.921326</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">2.9209614</td>
</tr>
<tr class="even">
<td style="text-align: left;">GlobRangeSize_m2</td>
<td style="text-align: right;">5.727284</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">16.7979052</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sd_PC1</td>
<td style="text-align: right;">5.718980</td>
<td style="text-align: right;">14.076340</td>
<td style="text-align: right;">7.7872239</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheInvertivore</td>
<td style="text-align: right;">5.623869</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.1503559</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Migration3</td>
<td style="text-align: right;">4.643083</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.1713392</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatShrubland</td>
<td style="text-align: right;">4.232290</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">9.2753732</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheOmnivore</td>
<td style="text-align: right;">4.097055</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">5.9681026</td>
</tr>
<tr class="even">
<td style="text-align: left;">sd_PC2</td>
<td style="text-align: right;">4.016345</td>
<td style="text-align: right;">5.302133</td>
<td style="text-align: right;">19.1236479</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatHuman Modified</td>
<td style="text-align: right;">3.692519</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.2937052</td>
</tr>
<tr class="even">
<td style="text-align: left;">Habitat.Density2</td>
<td style="text-align: right;">3.497430</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.7569752</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatMarine</td>
<td style="text-align: right;">3.377475</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.5020430</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatWoodland</td>
<td style="text-align: right;">3.268339</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.3012058</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary.LifestyleAquatic</td>
<td style="text-align: right;">3.059258</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.6132460</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary.LifestyleGeneralist</td>
<td style="text-align: right;">2.801960</td>
<td style="text-align: right;">2.345696</td>
<td style="text-align: right;">2.1335439</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheVertivore</td>
<td style="text-align: right;">2.587304</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.2386523</td>
</tr>
<tr class="even">
<td style="text-align: left;">IUCNVU</td>
<td style="text-align: right;">2.286203</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FP</td>
<td style="text-align: right;">2.255865</td>
<td style="text-align: right;">5.753691</td>
<td style="text-align: right;">7.4769549</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary.LifestyleTerrestrial</td>
<td style="text-align: right;">2.005726</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.0639151</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatRock</td>
<td style="text-align: right;">1.814880</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheScavenger</td>
<td style="text-align: right;">1.456081</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUCNEN</td>
<td style="text-align: right;">1.445156</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheFrugivore</td>
<td style="text-align: right;">1.422162</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatDesert</td>
<td style="text-align: right;">1.420688</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheNectarivore</td>
<td style="text-align: right;">1.420688</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheGranivore</td>
<td style="text-align: right;">1.349115</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.2014051</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatRiverine</td>
<td style="text-align: right;">1.279302</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheHerbivore terrestrial</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.2753928</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(ensembleModel_LR1) <span class="sc">%&gt;%</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(overall)) <span class="sc">%&gt;%</span> </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 45%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">overall</th>
<th style="text-align: right;">ranger</th>
<th style="text-align: right;">gbm</th>
<th style="text-align: right;">xgbTree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">D_AOO_a</td>
<td style="text-align: right;">9.9279619</td>
<td style="text-align: right;">9.5125401</td>
<td style="text-align: right;">17.6939777</td>
<td style="text-align: right;">13.3893446</td>
</tr>
<tr class="even">
<td style="text-align: left;">AlphaSR_sp</td>
<td style="text-align: right;">6.5397218</td>
<td style="text-align: right;">6.8849653</td>
<td style="text-align: right;">3.5110932</td>
<td style="text-align: right;">3.1053056</td>
</tr>
<tr class="odd">
<td style="text-align: left;">datasetBirds_atlas_EBBA</td>
<td style="text-align: right;">5.4363251</td>
<td style="text-align: right;">5.9892959</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0308028</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lon</td>
<td style="text-align: right;">5.0119333</td>
<td style="text-align: right;">5.0209245</td>
<td style="text-align: right;">2.8419212</td>
<td style="text-align: right;">5.2629952</td>
</tr>
<tr class="odd">
<td style="text-align: left;">datasetBirds_atlas_Japan</td>
<td style="text-align: right;">4.3587412</td>
<td style="text-align: right;">4.8042735</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_maxDist</td>
<td style="text-align: right;">4.1365875</td>
<td style="text-align: right;">4.4315410</td>
<td style="text-align: right;">2.6906313</td>
<td style="text-align: right;">1.0165720</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_relCirc</td>
<td style="text-align: right;">3.5524707</td>
<td style="text-align: right;">3.5897738</td>
<td style="text-align: right;">2.5687553</td>
<td style="text-align: right;">3.2882816</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southernness</td>
<td style="text-align: right;">3.2304574</td>
<td style="text-align: right;">3.2113260</td>
<td style="text-align: right;">6.9748939</td>
<td style="text-align: right;">2.8383859</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x_intercept</td>
<td style="text-align: right;">3.0640592</td>
<td style="text-align: right;">3.2832897</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.0689676</td>
</tr>
<tr class="even">
<td style="text-align: left;">atlas_widthMinRect</td>
<td style="text-align: right;">2.8725386</td>
<td style="text-align: right;">3.1661575</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Westernness</td>
<td style="text-align: right;">2.8611746</td>
<td style="text-align: right;">2.7297333</td>
<td style="text-align: right;">5.5838645</td>
<td style="text-align: right;">3.9131422</td>
</tr>
<tr class="even">
<td style="text-align: left;">IUCNLC</td>
<td style="text-align: right;">2.7797205</td>
<td style="text-align: right;">2.8741805</td>
<td style="text-align: right;">2.8029165</td>
<td style="text-align: right;">1.7013433</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moran</td>
<td style="text-align: right;">2.5825130</td>
<td style="text-align: right;">2.6188672</td>
<td style="text-align: right;">1.3193391</td>
<td style="text-align: right;">2.3746233</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_lin</td>
<td style="text-align: right;">2.4706258</td>
<td style="text-align: right;">2.4453067</td>
<td style="text-align: right;">2.4518271</td>
<td style="text-align: right;">2.7617234</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_occ_Ncells</td>
<td style="text-align: right;">2.4279490</td>
<td style="text-align: right;">2.1626926</td>
<td style="text-align: right;">4.7955967</td>
<td style="text-align: right;">5.0600404</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mass</td>
<td style="text-align: right;">2.2524567</td>
<td style="text-align: right;">1.9218254</td>
<td style="text-align: right;">7.2411481</td>
<td style="text-align: right;">5.2014796</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bearing</td>
<td style="text-align: right;">2.0063389</td>
<td style="text-align: right;">1.8148656</td>
<td style="text-align: right;">4.5973882</td>
<td style="text-align: right;">3.7626791</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lat</td>
<td style="text-align: right;">2.0061332</td>
<td style="text-align: right;">1.7792523</td>
<td style="text-align: right;">1.8881329</td>
<td style="text-align: right;">4.6063994</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bearingMinRect</td>
<td style="text-align: right;">1.7274451</td>
<td style="text-align: right;">1.7548552</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.6969047</td>
</tr>
<tr class="even">
<td style="text-align: left;">AOO</td>
<td style="text-align: right;">1.6665069</td>
<td style="text-align: right;">1.3428689</td>
<td style="text-align: right;">8.1896334</td>
<td style="text-align: right;">4.2861177</td>
</tr>
<tr class="odd">
<td style="text-align: left;">widthMinRect</td>
<td style="text-align: right;">1.6658987</td>
<td style="text-align: right;">1.6437852</td>
<td style="text-align: right;">3.3059001</td>
<td style="text-align: right;">1.6504227</td>
</tr>
<tr class="even">
<td style="text-align: left;">datasetBirds_Atlas_New_York</td>
<td style="text-align: right;">1.6644516</td>
<td style="text-align: right;">1.8345849</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_elonRatio</td>
<td style="text-align: right;">1.6435854</td>
<td style="text-align: right;">1.5955601</td>
<td style="text-align: right;">0.5034746</td>
<td style="text-align: right;">2.3755799</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dist_centroid_to_COG</td>
<td style="text-align: right;">1.6202403</td>
<td style="text-align: right;">1.5643364</td>
<td style="text-align: right;">0.6457174</td>
<td style="text-align: right;">2.4149009</td>
</tr>
<tr class="odd">
<td style="text-align: left;">BetaSR_sp</td>
<td style="text-align: right;">1.5951356</td>
<td style="text-align: right;">1.4789963</td>
<td style="text-align: right;">0.5894578</td>
<td style="text-align: right;">3.0801208</td>
</tr>
<tr class="even">
<td style="text-align: left;">mean_prob_cooccur</td>
<td style="text-align: right;">1.4489833</td>
<td style="text-align: right;">1.1829119</td>
<td style="text-align: right;">5.9389917</td>
<td style="text-align: right;">3.7447584</td>
</tr>
<tr class="odd">
<td style="text-align: left;">elonMinRect</td>
<td style="text-align: right;">1.4317912</td>
<td style="text-align: right;">1.4384167</td>
<td style="text-align: right;">0.9720997</td>
<td style="text-align: right;">1.4312697</td>
</tr>
<tr class="even">
<td style="text-align: left;">minDist_toBorder_centr</td>
<td style="text-align: right;">1.3970080</td>
<td style="text-align: right;">1.2755075</td>
<td style="text-align: right;">3.0815177</td>
<td style="text-align: right;">2.5049358</td>
</tr>
<tr class="odd">
<td style="text-align: left;">atlas_bearingMinRect</td>
<td style="text-align: right;">1.3520152</td>
<td style="text-align: right;">1.4902126</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Habitat.Density3</td>
<td style="text-align: right;">1.1016742</td>
<td style="text-align: right;">1.1632302</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.5807864</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatGrassland</td>
<td style="text-align: right;">1.0245602</td>
<td style="text-align: right;">1.0565355</td>
<td style="text-align: right;">1.4488756</td>
<td style="text-align: right;">0.5917082</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hand.Wing.Index</td>
<td style="text-align: right;">1.0060002</td>
<td style="text-align: right;">0.7362298</td>
<td style="text-align: right;">1.8227244</td>
<td style="text-align: right;">3.9419849</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatWetland</td>
<td style="text-align: right;">0.9793318</td>
<td style="text-align: right;">1.0780781</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0154366</td>
</tr>
<tr class="even">
<td style="text-align: left;">circ</td>
<td style="text-align: right;">0.9447011</td>
<td style="text-align: right;">0.9094419</td>
<td style="text-align: right;">1.2715356</td>
<td style="text-align: right;">1.2925993</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GlobRangeSize_m2</td>
<td style="text-align: right;">0.6736560</td>
<td style="text-align: right;">0.5448102</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">2.2491294</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatForest</td>
<td style="text-align: right;">0.6729878</td>
<td style="text-align: right;">0.7394525</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0264537</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sd_PC1</td>
<td style="text-align: right;">0.6090660</td>
<td style="text-align: right;">0.5440202</td>
<td style="text-align: right;">2.4906645</td>
<td style="text-align: right;">1.0426582</td>
</tr>
<tr class="even">
<td style="text-align: left;">IUCNNT</td>
<td style="text-align: right;">0.5928250</td>
<td style="text-align: right;">0.6197400</td>
<td style="text-align: right;">0.4066598</td>
<td style="text-align: right;">0.3169464</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sd_PC2</td>
<td style="text-align: right;">0.5630128</td>
<td style="text-align: right;">0.3820564</td>
<td style="text-align: right;">0.9381582</td>
<td style="text-align: right;">2.5605311</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheHerbivore aquatic</td>
<td style="text-align: right;">0.5625372</td>
<td style="text-align: right;">0.6196526</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0043772</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Migration2</td>
<td style="text-align: right;">0.5422231</td>
<td style="text-align: right;">0.5632685</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.3910976</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary.LifestyleInsessorial</td>
<td style="text-align: right;">0.5367683</td>
<td style="text-align: right;">0.5847717</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0780729</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheInvertivore</td>
<td style="text-align: right;">0.4976448</td>
<td style="text-align: right;">0.5349728</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.1540251</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatShrubland</td>
<td style="text-align: right;">0.4643060</td>
<td style="text-align: right;">0.4025983</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">1.2419117</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheOmnivore</td>
<td style="text-align: right;">0.4173193</td>
<td style="text-align: right;">0.3897340</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.7990898</td>
</tr>
<tr class="even">
<td style="text-align: left;">Migration3</td>
<td style="text-align: right;">0.4025452</td>
<td style="text-align: right;">0.4416751</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0229412</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatHuman Modified</td>
<td style="text-align: right;">0.3218146</td>
<td style="text-align: right;">0.3512523</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0393252</td>
</tr>
<tr class="even">
<td style="text-align: left;">Habitat.Density2</td>
<td style="text-align: right;">0.3206026</td>
<td style="text-align: right;">0.3326944</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.2352475</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatMarine</td>
<td style="text-align: right;">0.2968498</td>
<td style="text-align: right;">0.3212837</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0672203</td>
</tr>
<tr class="even">
<td style="text-align: left;">FP</td>
<td style="text-align: right;">0.2877498</td>
<td style="text-align: right;">0.2145901</td>
<td style="text-align: right;">1.0180569</td>
<td style="text-align: right;">1.0011153</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatWoodland</td>
<td style="text-align: right;">0.2852863</td>
<td style="text-align: right;">0.3109020</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0403295</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary.LifestyleAquatic</td>
<td style="text-align: right;">0.2812519</td>
<td style="text-align: right;">0.2910131</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.2160031</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Primary.LifestyleGeneralist</td>
<td style="text-align: right;">0.2699918</td>
<td style="text-align: right;">0.2665376</td>
<td style="text-align: right;">0.4150469</td>
<td style="text-align: right;">0.2856675</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheVertivore</td>
<td style="text-align: right;">0.2258425</td>
<td style="text-align: right;">0.2461183</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0319540</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUCNVU</td>
<td style="text-align: right;">0.1973080</td>
<td style="text-align: right;">0.2174760</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Primary.LifestyleTerrestrial</td>
<td style="text-align: right;">0.1844623</td>
<td style="text-align: right;">0.1907955</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.1424513</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatRock</td>
<td style="text-align: right;">0.1566310</td>
<td style="text-align: right;">0.1726412</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheScavenger</td>
<td style="text-align: right;">0.1256653</td>
<td style="text-align: right;">0.1385103</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUCNEN</td>
<td style="text-align: right;">0.1247224</td>
<td style="text-align: right;">0.1374710</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheFrugivore</td>
<td style="text-align: right;">0.1227379</td>
<td style="text-align: right;">0.1352837</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheNectarivore</td>
<td style="text-align: right;">0.1226107</td>
<td style="text-align: right;">0.1351435</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatDesert</td>
<td style="text-align: right;">0.1226107</td>
<td style="text-align: right;">0.1351435</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheGranivore</td>
<td style="text-align: right;">0.1185844</td>
<td style="text-align: right;">0.1283351</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0269668</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatRiverine</td>
<td style="text-align: right;">0.1104086</td>
<td style="text-align: right;">0.1216941</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheHerbivore terrestrial</td>
<td style="text-align: right;">0.0029407</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0368733</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(response, predictors, index, dd, dd_test, trained_control)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LR1: 84.14 sec elapsed</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="log-ratio-2" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Log Ratio 2</h1>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">Train model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Summarize individual models</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">Predictive performances</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">Ensemble model</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">Summarize predictor importances</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">tic</span>(<span class="st">"LR2"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define model variables  (response, indices and predictors)</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="st">"log_R2_1"</span> </span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>predictors <span class="ot">&lt;-</span> reduced_predictors[[<span class="dv">4</span>]] <span class="co"># Replace with your actual predictors</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>index <span class="ot">&lt;-</span> indices_LR2</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>dd <span class="ot">&lt;-</span> dat_train_LR2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(response, predictors)))</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>dd_test <span class="ot">&lt;-</span> dat_test_LR2 <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">all_of</span>(<span class="fu">c</span>(response, predictors)))</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Define training control</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>trained_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">savePredictions =</span> <span class="st">"final"</span>,</span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">returnResamp =</span> <span class="st">"final"</span>,</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">verboseIter =</span> <span class="cn">FALSE</span>,</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">index =</span> index <span class="co"># Ensure indices_LR2 is defined</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Train all models at once using caretList / using bestFit hyperparameters from 03_HyperparameterTuning.qmd</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>modelsList_LR2 <span class="ot">&lt;-</span> <span class="fu">caretList</span>(</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.formula</span>(<span class="fu">paste</span>(response, <span class="st">"~ ."</span>)),</span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dd,</span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> trained_control,</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneList =</span> <span class="fu">list</span>(</span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">ranger =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"ranger"</span>,</span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">mtry =</span> <span class="dv">52</span>,</span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">splitrule =</span> <span class="st">"extratrees"</span>,</span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">min.node.size =</span> <span class="dv">5</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a>      <span class="at">importance =</span> <span class="st">"permutation"</span>,</span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">num.trees =</span> <span class="dv">5000</span></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">gbm =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"gbm"</span>,</span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a>        <span class="at">n.trees =</span> <span class="dv">50</span>,</span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">interaction.depth =</span> <span class="dv">7</span>,</span>
<span id="cb49-43"><a href="#cb49-43" aria-hidden="true" tabindex="-1"></a>        <span class="at">shrinkage =</span> <span class="fl">0.1</span>,</span>
<span id="cb49-44"><a href="#cb49-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">n.minobsinnode =</span> <span class="dv">10</span></span>
<span id="cb49-45"><a href="#cb49-45" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb49-46"><a href="#cb49-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb49-47"><a href="#cb49-47" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb49-48"><a href="#cb49-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">xgbTree =</span> <span class="fu">caretModelSpec</span>(</span>
<span id="cb49-49"><a href="#cb49-49" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"xgbTree"</span>,</span>
<span id="cb49-50"><a href="#cb49-50" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb49-51"><a href="#cb49-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">nrounds =</span> <span class="dv">1000</span>,</span>
<span id="cb49-52"><a href="#cb49-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">eta =</span> <span class="fl">0.1</span>,</span>
<span id="cb49-53"><a href="#cb49-53" aria-hidden="true" tabindex="-1"></a>        <span class="at">max_depth =</span> <span class="dv">5</span>,</span>
<span id="cb49-54"><a href="#cb49-54" aria-hidden="true" tabindex="-1"></a>        <span class="at">gamma =</span> <span class="fl">0.1</span>,</span>
<span id="cb49-55"><a href="#cb49-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">colsample_bytree =</span> <span class="fl">0.6</span>,</span>
<span id="cb49-56"><a href="#cb49-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">min_child_weight =</span> <span class="dv">1</span>,</span>
<span id="cb49-57"><a href="#cb49-57" aria-hidden="true" tabindex="-1"></a>        <span class="at">subsample =</span> <span class="dv">1</span></span>
<span id="cb49-58"><a href="#cb49-58" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb49-59"><a href="#cb49-59" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb49-60"><a href="#cb49-60" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb49-61"><a href="#cb49-61" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Summarzize across individual models ========================================#</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create resamples from the list of models</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>resamps_LR2 <span class="ot">&lt;-</span> <span class="fu">resamples</span>(modelsList_LR2)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the resampled error rates for each model</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>dotplot_resamps_LR2 <span class="ot">&lt;-</span> <span class="fu">dotplot</span>(resamps_LR2)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the resamples</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>summary_resamps_LR2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(resamps_LR2)</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine everything into a list</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>resamples_all_LR2 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">Jaccard1 =</span> <span class="fu">list</span>(</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">resamps_LR2 =</span> resamps_LR2,</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Dotplot =</span> dotplot_resamps_LR2, <span class="co"># store the dotplot object</span></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">Summary =</span> summary_resamps_LR2  <span class="co"># store the summary object</span></span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a>resamples_all_LR2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Jaccard1
$Jaccard1$resamps_LR2

Call:
resamples.default(x = modelsList_LR2)

Models: ranger, gbm, xgbTree 
Number of resamples: 10 
Performance metrics: MAE, RMSE, Rsquared 
Time estimates for: everything, final model fit 

$Jaccard1$Dotplot</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="04_FinalModels_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
$Jaccard1$Summary

Call:
summary.resamples(object = resamps_LR2)

Models: ranger, gbm, xgbTree 
Number of resamples: 10 

MAE 
             Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
ranger  0.3004566 0.3102128 0.3328967 0.3301751 0.3451095 0.3652087    0
gbm     0.3135943 0.3219454 0.3451893 0.3444557 0.3621308 0.3862579    0
xgbTree 0.3087705 0.3220933 0.3501550 0.3430031 0.3573145 0.3742934    0

RMSE 
             Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
ranger  0.4730713 0.5097311 0.5262349 0.5340082 0.5596536 0.6167102    0
gbm     0.4889392 0.5145147 0.5353704 0.5449522 0.5817995 0.6148332    0
xgbTree 0.4861044 0.5169500 0.5383450 0.5427940 0.5663961 0.6092266    0

Rsquared 
              Min.   1st Qu.    Median      Mean   3rd Qu.      Max. NA's
ranger  0.06949563 0.1513409 0.2025256 0.1840501 0.2313987 0.2711515    0
gbm     0.05656313 0.1190845 0.1314444 0.1555374 0.1773010 0.3341799    0
xgbTree 0.06441885 0.1349925 0.1462681 0.1673689 0.1964141 0.3395451    0</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Predictive Performance analysis ================================================</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>p_LR2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(modelsList_LR2, <span class="at">newdata =</span> dd_test)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cbind</span>(dd_test<span class="sc">$</span>log_R2_1) <span class="sc">%&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_ranger =</span> dd_test<span class="sc">$</span>log_R2_1<span class="sc">-</span>ranger,</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_gbm =</span> dd_test<span class="sc">$</span>log_R2_1<span class="sc">-</span>gbm,</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">error_xgb =</span> dd_test<span class="sc">$</span>log_R2_1<span class="sc">-</span>xgbTree) </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>p_LR2 <span class="sc">%&gt;%</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_ranger =</span> <span class="fu">mean</span>(error_ranger),</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_gbm =</span> <span class="fu">mean</span>(error_gbm),</span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">mean_xgb =</span> <span class="fu">mean</span>(error_xgb)) <span class="sc">%&gt;%</span> </span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>() <span class="co"># ranger performs best</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">mean_ranger</th>
<th style="text-align: right;">mean_gbm</th>
<th style="text-align: right;">mean_xgb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.0190872</td>
<td style="text-align: right;">0.0256455</td>
<td style="text-align: right;">0.0106742</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<p>The ensemble model is not better than the ranger model alone. In fact, it’s a bit worse. We will discard the ensembleModel approach therefore.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the ensemble model ================================================</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Are they correlated? </span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># yes. not the best foundation for ensembleModels...</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="fu">modelCor</span>(<span class="fu">resamples</span>(modelsList_LR2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           ranger       gbm   xgbTree
ranger  1.0000000 0.9432978 0.8818711
gbm     0.9432978 1.0000000 0.8783226
xgbTree 0.8818711 0.8783226 1.0000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>ensembleModel_LR2 <span class="ot">&lt;-</span> <span class="fu">caretEnsemble</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>    modelsList_LR2,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">metric =</span> <span class="st">"Rsquared"</span>,</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> trained_control)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ensembleModel_LR2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The following models were ensembled: ranger, gbm, xgbTree 
They were weighted: 
-0.0032 0.638 0.1287 0.2721
The resulting Rsquared is: 0.133
The fit for each individual model on the Rsquared is: 
  method  Rsquared RsquaredSD
  ranger 0.1840501 0.06937784
     gbm 0.1555374 0.07997992
 xgbTree 0.1673689 0.07606861</code></pre>
</div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize predictor importances ============================================</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(ensembleModel_LR2) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(overall))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                       overall      ranger        gbm
AlphaSR_sp                         10.11612443 13.45387191  3.5872870
D_AOO_a                             7.06423408  8.03006401  6.3709632
Mass                                5.91125118  4.39197715  7.2125691
rel_occ_Ncells                      5.28562183  3.22690854 13.2052189
moran                               5.00331582  5.62424144  2.8997142
sp_centr_lon                        4.02991924  3.96897188  4.0128941
rel_lin                             3.90108847  3.96228598  4.9163448
Westernness                         3.40195764  3.77229024  3.7513181
Southernness                        3.34686900  3.76580936  1.3683501
rel_relCirc                         3.30619278  3.38336812  4.0674227
rel_elonRatio                       3.08612960  2.83408947  5.1146154
datasetBirds_atlas_EBBA             2.99755240  4.82616959  0.0000000
widthMinRect                        2.64957109  1.84166274  1.8380608
rel_maxDist                         2.58844044  2.93431106  2.5373628
bearing                             2.56053181  2.05404239  1.3756330
BetaSR_sp                           2.39102205  1.63847017  3.8209994
x_intercept                         2.30105690  2.69313081  1.9823862
minDist_toBorder_centr              2.23511502  2.11218934  1.3225806
AOO                                 2.09620916  1.38227673  3.3300574
Hand.Wing.Index                     1.89980004  1.00235087  2.5155682
elonMinRect                         1.83402244  1.35836400  2.6217947
bearingMinRect                      1.80386776  1.42145124  3.8604522
GlobRangeSize_m2                    1.75300372  0.80935280  3.3411735
sp_centr_lat                        1.72544295  1.56041066  2.0281839
HabitatWetland                      1.66402311  2.55889300  0.4809024
sd_PC1                              1.61308232  0.88912136  1.7297101
FP                                  1.60759743  0.26447157  3.3844611
circ                                1.48092238  0.97277223  3.0885051
sd_PC2                              1.43763481  0.77443396  1.7672393
Dist_centroid_to_COG                1.23525714  1.28641647  0.5443269
datasetBirds_Atlas_New_York         1.22349209  1.99200586  0.0000000
Trophic.NicheOmnivore               1.02904114  1.54241367  0.0000000
atlas_bearingMinRect                0.99347834  1.41773538  0.6469355
datasetBirds_atlas_Japan            0.76252634  1.24149306  0.0000000
IUCNLC                              0.75452607  0.73905538  1.0666336
Trophic.NicheHerbivore aquatic      0.64692302  1.03101451  0.0000000
HabitatForest                       0.48606626  0.69272147  0.0000000
IUCNNT                              0.40742195  0.60497066  0.0000000
HabitatShrubland                    0.36438088  0.52361921  0.0000000
Trophic.NicheInvertivore            0.24672857  0.31287260  0.2103360
HabitatHuman Modified               0.22427470  0.29270708  0.0000000
Trophic.NicheVertivore              0.08939105  0.13925314  0.0000000
HabitatMarine                       0.07209556  0.11738104  0.0000000
HabitatGrassland                    0.06687058  0.10887409  0.0000000
HabitatWoodland                     0.06413768  0.08586770  0.0000000
IUCNEN                              0.03521777  0.05733915  0.0000000
Trophic.NicheScavenger              0.03301031  0.05374512  0.0000000
HabitatDesert                       0.03061986  0.04985316  0.0000000
Trophic.NicheNectarivore            0.03061986  0.04985316  0.0000000
Trophic.NicheFrugivore              0.03051382  0.04678184  0.0000000
IUCNVU                              0.02388750  0.03512442  0.0000000
HabitatRiverine                     0.01897091  0.03088713  0.0000000
Trophic.NicheHerbivore terrestrial  0.01421970  0.00000000  0.0000000
Trophic.NicheGranivore              0.01308781  0.02130868  0.0000000
HabitatRock                         0.01164118  0.01895338  0.0000000
                                       xgbTree
AlphaSR_sp                         5.377015354
D_AOO_a                            5.127273752
Mass                               8.858445885
rel_occ_Ncells                     6.367675417
moran                              4.542160649
sp_centr_lon                       4.180891012
rel_lin                            3.277417429
Westernness                        2.368309039
Southernness                       3.300205388
rel_relCirc                        2.765195816
rel_elonRatio                      2.717785324
datasetBirds_atlas_EBBA            0.127190053
widthMinRect                       4.927895160
rel_maxDist                        1.801541382
bearing                            4.308631322
BetaSR_sp                          3.479426951
x_intercept                        1.532370430
minDist_toBorder_centr             2.954954537
AOO                                3.186811726
Hand.Wing.Index                    3.713064370
elonMinRect                        2.576850948
bearingMinRect                     1.727962972
GlobRangeSize_m2                   3.214713143
sp_centr_lat                       1.969257589
HabitatWetland                     0.125136104
sd_PC1                             3.255590054
FP                                 3.916820977
circ                               1.912214237
sd_PC2                             2.836934725
Dist_centroid_to_COG               1.442064965
datasetBirds_Atlas_New_York        0.000000000
Trophic.NicheOmnivore              0.311882158
atlas_bearingMinRect               0.162505481
datasetBirds_atlas_Japan           0.000000000
IUCNLC                             0.643193405
Trophic.NicheHerbivore aquatic     0.052201733
HabitatForest                      0.231350658
IUCNNT                             0.136866060
HabitatShrubland                   0.163305439
Trophic.NicheInvertivore           0.108834604
HabitatHuman Modified              0.169873359
Trophic.NicheVertivore             0.014743358
HabitatMarine                      0.000000000
HabitatGrassland                   0.000000000
HabitatWoodland                    0.043515297
IUCNEN                             0.000000000
Trophic.NicheScavenger             0.000000000
HabitatDesert                      0.000000000
Trophic.NicheNectarivore           0.000000000
Trophic.NicheFrugivore             0.006797264
IUCNVU                             0.008834825
HabitatRiverine                    0.000000000
Trophic.NicheHerbivore terrestrial 0.054289652
Trophic.NicheGranivore             0.000000000
HabitatRock                        0.000000000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ranger</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>imp_ranger <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_LR2[[<span class="dv">1</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_ranger"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>imp_ranger<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_ranger)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># gbm</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>imp_gbm <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_LR2[[<span class="dv">2</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_gbm"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>imp_gbm<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_gbm)</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>imp_merged <span class="ot">&lt;-</span> <span class="fu">merge</span>(imp_ranger, imp_gbm)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a><span class="co"># xgb</span></span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>imp_xgb <span class="ot">&lt;-</span> <span class="fu">varImp</span>(modelsList_LR2[[<span class="dv">3</span>]])<span class="sc">$</span>importance <span class="sc">%&gt;%</span> </span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.data.frame</span>()<span class="sc">%&gt;%</span> </span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">"imp_xgb"</span> <span class="ot">=</span> <span class="st">"Overall"</span>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>imp_xgb<span class="sc">$</span>var <span class="ot">&lt;-</span> <span class="fu">row.names</span>(imp_xgb)</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>imp_merged_all_LR2 <span class="ot">&lt;-</span> <span class="fu">merge</span>(imp_merged, imp_xgb) <span class="sc">%&gt;%</span> </span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(imp_ranger))</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Print results</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>imp_merged_all_LR2 <span class="sc">%&gt;%</span> </span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 50%">
<col style="width: 17%">
<col style="width: 15%">
<col style="width: 17%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">var</th>
<th style="text-align: right;">imp_ranger</th>
<th style="text-align: right;">imp_gbm</th>
<th style="text-align: right;">imp_xgb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AlphaSR_sp</td>
<td style="text-align: right;">100.0000000</td>
<td style="text-align: right;">27.165676</td>
<td style="text-align: right;">60.6993080</td>
</tr>
<tr class="even">
<td style="text-align: left;">D_AOO_a</td>
<td style="text-align: right;">59.6858961</td>
<td style="text-align: right;">48.245798</td>
<td style="text-align: right;">57.8800595</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moran</td>
<td style="text-align: right;">41.8038872</td>
<td style="text-align: right;">21.958850</td>
<td style="text-align: right;">51.2749156</td>
</tr>
<tr class="even">
<td style="text-align: left;">datasetBirds_atlas_EBBA</td>
<td style="text-align: right;">35.8719752</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.4358055</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mass</td>
<td style="text-align: right;">32.6447077</td>
<td style="text-align: right;">54.619080</td>
<td style="text-align: right;">100.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lon</td>
<td style="text-align: right;">29.5005921</td>
<td style="text-align: right;">30.388698</td>
<td style="text-align: right;">47.1966648</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_lin</td>
<td style="text-align: right;">29.4508971</td>
<td style="text-align: right;">37.230317</td>
<td style="text-align: right;">36.9976571</td>
</tr>
<tr class="even">
<td style="text-align: left;">Westernness</td>
<td style="text-align: right;">28.0386960</td>
<td style="text-align: right;">28.407845</td>
<td style="text-align: right;">26.7350399</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Southernness</td>
<td style="text-align: right;">27.9905249</td>
<td style="text-align: right;">10.362192</td>
<td style="text-align: right;">37.2549026</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_relCirc</td>
<td style="text-align: right;">25.1479139</td>
<td style="text-align: right;">30.801630</td>
<td style="text-align: right;">31.2153605</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_occ_Ncells</td>
<td style="text-align: right;">23.9849804</td>
<td style="text-align: right;">100.000000</td>
<td style="text-align: right;">71.8825345</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_maxDist</td>
<td style="text-align: right;">21.8101605</td>
<td style="text-align: right;">19.214848</td>
<td style="text-align: right;">20.3369915</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_elonRatio</td>
<td style="text-align: right;">21.0652331</td>
<td style="text-align: right;">38.731773</td>
<td style="text-align: right;">30.6801595</td>
</tr>
<tr class="even">
<td style="text-align: left;">x_intercept</td>
<td style="text-align: right;">20.0175149</td>
<td style="text-align: right;">15.012142</td>
<td style="text-align: right;">17.2984116</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatWetland</td>
<td style="text-align: right;">19.0197515</td>
<td style="text-align: right;">3.641760</td>
<td style="text-align: right;">1.4126192</td>
</tr>
<tr class="even">
<td style="text-align: left;">minDist_toBorder_centr</td>
<td style="text-align: right;">15.6994905</td>
<td style="text-align: right;">10.015590</td>
<td style="text-align: right;">33.3574825</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bearing</td>
<td style="text-align: right;">15.2672955</td>
<td style="text-align: right;">10.417343</td>
<td style="text-align: right;">48.6386820</td>
</tr>
<tr class="even">
<td style="text-align: left;">datasetBirds_Atlas_New_York</td>
<td style="text-align: right;">14.8061902</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">widthMinRect</td>
<td style="text-align: right;">13.6887191</td>
<td style="text-align: right;">13.919199</td>
<td style="text-align: right;">55.6293420</td>
</tr>
<tr class="even">
<td style="text-align: left;">BetaSR_sp</td>
<td style="text-align: right;">12.1784285</td>
<td style="text-align: right;">28.935525</td>
<td style="text-align: right;">39.2780742</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sp_centr_lat</td>
<td style="text-align: right;">11.5982274</td>
<td style="text-align: right;">15.358957</td>
<td style="text-align: right;">22.2302830</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheOmnivore</td>
<td style="text-align: right;">11.4644593</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">3.5207322</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bearingMinRect</td>
<td style="text-align: right;">10.5653692</td>
<td style="text-align: right;">29.234292</td>
<td style="text-align: right;">19.5063897</td>
</tr>
<tr class="even">
<td style="text-align: left;">atlas_bearingMinRect</td>
<td style="text-align: right;">10.5377500</td>
<td style="text-align: right;">4.899089</td>
<td style="text-align: right;">1.8344694</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AOO</td>
<td style="text-align: right;">10.2741928</td>
<td style="text-align: right;">25.217737</td>
<td style="text-align: right;">35.9748399</td>
</tr>
<tr class="even">
<td style="text-align: left;">elonMinRect</td>
<td style="text-align: right;">10.0964541</td>
<td style="text-align: right;">19.854231</td>
<td style="text-align: right;">29.0891990</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dist_centroid_to_COG</td>
<td style="text-align: right;">9.5616822</td>
<td style="text-align: right;">4.122059</td>
<td style="text-align: right;">16.2789837</td>
</tr>
<tr class="even">
<td style="text-align: left;">datasetBirds_atlas_Japan</td>
<td style="text-align: right;">9.2277752</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheHerbivore aquatic</td>
<td style="text-align: right;">7.6633293</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.5892877</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hand.Wing.Index</td>
<td style="text-align: right;">7.4502781</td>
<td style="text-align: right;">19.049803</td>
<td style="text-align: right;">41.9155280</td>
</tr>
<tr class="odd">
<td style="text-align: left;">circ</td>
<td style="text-align: right;">7.2304258</td>
<td style="text-align: right;">23.388519</td>
<td style="text-align: right;">21.5863399</td>
</tr>
<tr class="even">
<td style="text-align: left;">sd_PC1</td>
<td style="text-align: right;">6.6086653</td>
<td style="text-align: right;">13.098685</td>
<td style="text-align: right;">36.7512552</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GlobRangeSize_m2</td>
<td style="text-align: right;">6.0157612</td>
<td style="text-align: right;">25.301917</td>
<td style="text-align: right;">36.2898096</td>
</tr>
<tr class="even">
<td style="text-align: left;">sd_PC2</td>
<td style="text-align: right;">5.7562163</td>
<td style="text-align: right;">13.382885</td>
<td style="text-align: right;">32.0251968</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUCNLC</td>
<td style="text-align: right;">5.4932541</td>
<td style="text-align: right;">8.077364</td>
<td style="text-align: right;">7.2607928</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatForest</td>
<td style="text-align: right;">5.1488633</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">2.6116393</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUCNNT</td>
<td style="text-align: right;">4.4966286</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.5450347</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatShrubland</td>
<td style="text-align: right;">3.8919593</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.8434999</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheInvertivore</td>
<td style="text-align: right;">2.3255209</td>
<td style="text-align: right;">1.592825</td>
<td style="text-align: right;">1.2285970</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatHuman Modified</td>
<td style="text-align: right;">2.1756345</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">1.9176429</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FP</td>
<td style="text-align: right;">1.9657655</td>
<td style="text-align: right;">25.629724</td>
<td style="text-align: right;">44.2156675</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheVertivore</td>
<td style="text-align: right;">1.0350414</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.1664328</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatMarine</td>
<td style="text-align: right;">0.8724703</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatGrassland</td>
<td style="text-align: right;">0.8092399</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatWoodland</td>
<td style="text-align: right;">0.6382378</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.4912295</td>
</tr>
<tr class="even">
<td style="text-align: left;">IUCNEN</td>
<td style="text-align: right;">0.4261907</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheScavenger</td>
<td style="text-align: right;">0.3994770</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatDesert</td>
<td style="text-align: right;">0.3705488</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheNectarivore</td>
<td style="text-align: right;">0.3705488</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheFrugivore</td>
<td style="text-align: right;">0.3477203</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0767320</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUCNVU</td>
<td style="text-align: right;">0.2610730</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0997333</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatRiverine</td>
<td style="text-align: right;">0.2295780</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheGranivore</td>
<td style="text-align: right;">0.1583832</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatRock</td>
<td style="text-align: right;">0.1408767</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheHerbivore terrestrial</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.000000</td>
<td style="text-align: right;">0.6128575</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(ensembleModel_LR2) <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(overall)) <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  kableExtra<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 44%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">overall</th>
<th style="text-align: right;">ranger</th>
<th style="text-align: right;">gbm</th>
<th style="text-align: right;">xgbTree</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">AlphaSR_sp</td>
<td style="text-align: right;">10.1161244</td>
<td style="text-align: right;">13.4538719</td>
<td style="text-align: right;">3.5872870</td>
<td style="text-align: right;">5.3770154</td>
</tr>
<tr class="even">
<td style="text-align: left;">D_AOO_a</td>
<td style="text-align: right;">7.0642341</td>
<td style="text-align: right;">8.0300640</td>
<td style="text-align: right;">6.3709632</td>
<td style="text-align: right;">5.1272738</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mass</td>
<td style="text-align: right;">5.9112512</td>
<td style="text-align: right;">4.3919772</td>
<td style="text-align: right;">7.2125691</td>
<td style="text-align: right;">8.8584459</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_occ_Ncells</td>
<td style="text-align: right;">5.2856218</td>
<td style="text-align: right;">3.2269085</td>
<td style="text-align: right;">13.2052189</td>
<td style="text-align: right;">6.3676754</td>
</tr>
<tr class="odd">
<td style="text-align: left;">moran</td>
<td style="text-align: right;">5.0033158</td>
<td style="text-align: right;">5.6242414</td>
<td style="text-align: right;">2.8997142</td>
<td style="text-align: right;">4.5421606</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lon</td>
<td style="text-align: right;">4.0299192</td>
<td style="text-align: right;">3.9689719</td>
<td style="text-align: right;">4.0128941</td>
<td style="text-align: right;">4.1808910</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_lin</td>
<td style="text-align: right;">3.9010885</td>
<td style="text-align: right;">3.9622860</td>
<td style="text-align: right;">4.9163448</td>
<td style="text-align: right;">3.2774174</td>
</tr>
<tr class="even">
<td style="text-align: left;">Westernness</td>
<td style="text-align: right;">3.4019576</td>
<td style="text-align: right;">3.7722902</td>
<td style="text-align: right;">3.7513181</td>
<td style="text-align: right;">2.3683090</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Southernness</td>
<td style="text-align: right;">3.3468690</td>
<td style="text-align: right;">3.7658094</td>
<td style="text-align: right;">1.3683501</td>
<td style="text-align: right;">3.3002054</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_relCirc</td>
<td style="text-align: right;">3.3061928</td>
<td style="text-align: right;">3.3833681</td>
<td style="text-align: right;">4.0674227</td>
<td style="text-align: right;">2.7651958</td>
</tr>
<tr class="odd">
<td style="text-align: left;">rel_elonRatio</td>
<td style="text-align: right;">3.0861296</td>
<td style="text-align: right;">2.8340895</td>
<td style="text-align: right;">5.1146154</td>
<td style="text-align: right;">2.7177853</td>
</tr>
<tr class="even">
<td style="text-align: left;">datasetBirds_atlas_EBBA</td>
<td style="text-align: right;">2.9975524</td>
<td style="text-align: right;">4.8261696</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.1271901</td>
</tr>
<tr class="odd">
<td style="text-align: left;">widthMinRect</td>
<td style="text-align: right;">2.6495711</td>
<td style="text-align: right;">1.8416627</td>
<td style="text-align: right;">1.8380608</td>
<td style="text-align: right;">4.9278952</td>
</tr>
<tr class="even">
<td style="text-align: left;">rel_maxDist</td>
<td style="text-align: right;">2.5884404</td>
<td style="text-align: right;">2.9343111</td>
<td style="text-align: right;">2.5373628</td>
<td style="text-align: right;">1.8015414</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bearing</td>
<td style="text-align: right;">2.5605318</td>
<td style="text-align: right;">2.0540424</td>
<td style="text-align: right;">1.3756330</td>
<td style="text-align: right;">4.3086313</td>
</tr>
<tr class="even">
<td style="text-align: left;">BetaSR_sp</td>
<td style="text-align: right;">2.3910220</td>
<td style="text-align: right;">1.6384702</td>
<td style="text-align: right;">3.8209994</td>
<td style="text-align: right;">3.4794270</td>
</tr>
<tr class="odd">
<td style="text-align: left;">x_intercept</td>
<td style="text-align: right;">2.3010569</td>
<td style="text-align: right;">2.6931308</td>
<td style="text-align: right;">1.9823862</td>
<td style="text-align: right;">1.5323704</td>
</tr>
<tr class="even">
<td style="text-align: left;">minDist_toBorder_centr</td>
<td style="text-align: right;">2.2351150</td>
<td style="text-align: right;">2.1121893</td>
<td style="text-align: right;">1.3225806</td>
<td style="text-align: right;">2.9549545</td>
</tr>
<tr class="odd">
<td style="text-align: left;">AOO</td>
<td style="text-align: right;">2.0962092</td>
<td style="text-align: right;">1.3822767</td>
<td style="text-align: right;">3.3300574</td>
<td style="text-align: right;">3.1868117</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hand.Wing.Index</td>
<td style="text-align: right;">1.8998000</td>
<td style="text-align: right;">1.0023509</td>
<td style="text-align: right;">2.5155682</td>
<td style="text-align: right;">3.7130644</td>
</tr>
<tr class="odd">
<td style="text-align: left;">elonMinRect</td>
<td style="text-align: right;">1.8340224</td>
<td style="text-align: right;">1.3583640</td>
<td style="text-align: right;">2.6217947</td>
<td style="text-align: right;">2.5768509</td>
</tr>
<tr class="even">
<td style="text-align: left;">bearingMinRect</td>
<td style="text-align: right;">1.8038678</td>
<td style="text-align: right;">1.4214512</td>
<td style="text-align: right;">3.8604522</td>
<td style="text-align: right;">1.7279630</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GlobRangeSize_m2</td>
<td style="text-align: right;">1.7530037</td>
<td style="text-align: right;">0.8093528</td>
<td style="text-align: right;">3.3411735</td>
<td style="text-align: right;">3.2147131</td>
</tr>
<tr class="even">
<td style="text-align: left;">sp_centr_lat</td>
<td style="text-align: right;">1.7254429</td>
<td style="text-align: right;">1.5604107</td>
<td style="text-align: right;">2.0281839</td>
<td style="text-align: right;">1.9692576</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatWetland</td>
<td style="text-align: right;">1.6640231</td>
<td style="text-align: right;">2.5588930</td>
<td style="text-align: right;">0.4809024</td>
<td style="text-align: right;">0.1251361</td>
</tr>
<tr class="even">
<td style="text-align: left;">sd_PC1</td>
<td style="text-align: right;">1.6130823</td>
<td style="text-align: right;">0.8891214</td>
<td style="text-align: right;">1.7297101</td>
<td style="text-align: right;">3.2555901</td>
</tr>
<tr class="odd">
<td style="text-align: left;">FP</td>
<td style="text-align: right;">1.6075974</td>
<td style="text-align: right;">0.2644716</td>
<td style="text-align: right;">3.3844611</td>
<td style="text-align: right;">3.9168210</td>
</tr>
<tr class="even">
<td style="text-align: left;">circ</td>
<td style="text-align: right;">1.4809224</td>
<td style="text-align: right;">0.9727722</td>
<td style="text-align: right;">3.0885051</td>
<td style="text-align: right;">1.9122142</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sd_PC2</td>
<td style="text-align: right;">1.4376348</td>
<td style="text-align: right;">0.7744340</td>
<td style="text-align: right;">1.7672393</td>
<td style="text-align: right;">2.8369347</td>
</tr>
<tr class="even">
<td style="text-align: left;">Dist_centroid_to_COG</td>
<td style="text-align: right;">1.2352571</td>
<td style="text-align: right;">1.2864165</td>
<td style="text-align: right;">0.5443269</td>
<td style="text-align: right;">1.4420650</td>
</tr>
<tr class="odd">
<td style="text-align: left;">datasetBirds_Atlas_New_York</td>
<td style="text-align: right;">1.2234921</td>
<td style="text-align: right;">1.9920059</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheOmnivore</td>
<td style="text-align: right;">1.0290411</td>
<td style="text-align: right;">1.5424137</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.3118822</td>
</tr>
<tr class="odd">
<td style="text-align: left;">atlas_bearingMinRect</td>
<td style="text-align: right;">0.9934783</td>
<td style="text-align: right;">1.4177354</td>
<td style="text-align: right;">0.6469355</td>
<td style="text-align: right;">0.1625055</td>
</tr>
<tr class="even">
<td style="text-align: left;">datasetBirds_atlas_Japan</td>
<td style="text-align: right;">0.7625263</td>
<td style="text-align: right;">1.2414931</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUCNLC</td>
<td style="text-align: right;">0.7545261</td>
<td style="text-align: right;">0.7390554</td>
<td style="text-align: right;">1.0666336</td>
<td style="text-align: right;">0.6431934</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheHerbivore aquatic</td>
<td style="text-align: right;">0.6469230</td>
<td style="text-align: right;">1.0310145</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0522017</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatForest</td>
<td style="text-align: right;">0.4860663</td>
<td style="text-align: right;">0.6927215</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.2313507</td>
</tr>
<tr class="even">
<td style="text-align: left;">IUCNNT</td>
<td style="text-align: right;">0.4074220</td>
<td style="text-align: right;">0.6049707</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.1368661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatShrubland</td>
<td style="text-align: right;">0.3643809</td>
<td style="text-align: right;">0.5236192</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.1633054</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheInvertivore</td>
<td style="text-align: right;">0.2467286</td>
<td style="text-align: right;">0.3128726</td>
<td style="text-align: right;">0.2103360</td>
<td style="text-align: right;">0.1088346</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatHuman Modified</td>
<td style="text-align: right;">0.2242747</td>
<td style="text-align: right;">0.2927071</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.1698734</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheVertivore</td>
<td style="text-align: right;">0.0893910</td>
<td style="text-align: right;">0.1392531</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0147434</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatMarine</td>
<td style="text-align: right;">0.0720956</td>
<td style="text-align: right;">0.1173810</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatGrassland</td>
<td style="text-align: right;">0.0668706</td>
<td style="text-align: right;">0.1088741</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatWoodland</td>
<td style="text-align: right;">0.0641377</td>
<td style="text-align: right;">0.0858677</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0435153</td>
</tr>
<tr class="even">
<td style="text-align: left;">IUCNEN</td>
<td style="text-align: right;">0.0352178</td>
<td style="text-align: right;">0.0573392</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheScavenger</td>
<td style="text-align: right;">0.0330103</td>
<td style="text-align: right;">0.0537451</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatDesert</td>
<td style="text-align: right;">0.0306199</td>
<td style="text-align: right;">0.0498532</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheNectarivore</td>
<td style="text-align: right;">0.0306199</td>
<td style="text-align: right;">0.0498532</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheFrugivore</td>
<td style="text-align: right;">0.0305138</td>
<td style="text-align: right;">0.0467818</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0067973</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IUCNVU</td>
<td style="text-align: right;">0.0238875</td>
<td style="text-align: right;">0.0351244</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0088348</td>
</tr>
<tr class="even">
<td style="text-align: left;">HabitatRiverine</td>
<td style="text-align: right;">0.0189709</td>
<td style="text-align: right;">0.0308871</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Trophic.NicheHerbivore terrestrial</td>
<td style="text-align: right;">0.0142197</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0542897</td>
</tr>
<tr class="even">
<td style="text-align: left;">Trophic.NicheGranivore</td>
<td style="text-align: right;">0.0130878</td>
<td style="text-align: right;">0.0213087</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">HabitatRock</td>
<td style="text-align: right;">0.0116412</td>
<td style="text-align: right;">0.0189534</td>
<td style="text-align: right;">0.0000000</td>
<td style="text-align: right;">0.0000000</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(response, predictors, index, dd, dd_test, trained_control)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>tictoc<span class="sc">::</span><span class="fu">toc</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>LR2: 107.97 sec elapsed</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="save-the-models" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Save the models</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">"../data/RData/04_FinalModels.RData"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03_HyperparameterTuning.html" class="pagination-link" aria-label="Script 3 - Hyperparameter Tuning">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Script 3 - Hyperparameter Tuning</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05_VarPart.html" class="pagination-link" aria-label="MachineLearning - Script 5 - Variation Partitioning">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">MachineLearning - Script 5 - Variation Partitioning</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/FriedaRosa/Assignment_Statistics_KVHEM_CZU_SS2024/edit/main/04_FinalModels.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>